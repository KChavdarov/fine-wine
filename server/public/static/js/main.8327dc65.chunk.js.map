{"version":3,"sources":["services/http.js","services/wineService.js","services/userService.js","store/slices/userSlice.js","store/slices/cartSlice.js","components/shared/ProductCard/ProductCard.js","components/pages/Catalogue/CheckboxGroup.js","components/pages/Catalogue/RangeGroup.js","components/pages/Catalogue/Filters.js","components/shared/Paginator/Paginator.js","components/shared/Loader/Loader.js","components/pages/Catalogue/Catalogue.js","components/Header/menuItems.js","components/Header/Header.js","components/pages/Home/Carousel/carouselContent.js","components/pages/Home/Carousel/Slide.js","components/pages/Home/Carousel/Carousel.js","components/pages/Home/ProductShowcase/ProductsShowcase.js","components/pages/Home/Home.js","components/Footer/Footer.js","components/pages/Auth/Auth.js","guards/guards.js","util/formik.js","components/pages/Auth/Login/Login.js","components/pages/Auth/Register/Register.js","components/pages/Auth/Logout.js","components/pages/Cart/Cart.js","components/pages/User/User.js","services/orderService.js","components/pages/User/Profile/Profile.js","components/pages/Cart/Checkout/Checkout.js","components/pages/Cart/Summary/CartItem.js","components/pages/Cart/Summary/Summary.js","components/pages/User/Favorites/Favorites.js","components/shared/Modal/Modal.js","components/pages/Details/Details.js","components/pages/Admin/Admin.js","components/pages/Admin/FileDropzone.js","components/pages/Admin/Create/Create.js","components/pages/Error/Error.js","components/pages/Admin/Edit/Edit.js","components/pages/Admin/Dashboard.js/Dashboard.js","components/pages/OrderDetails/OrderDetails.js","App.js","store/store.js","index.js"],"names":["endpoint","request","url","options","a","fetch","response","ok","json","createOptions","method","data","credentials","headers","FormData","body","JSON","stringify","get","post","put","patch","del","http","getCategories","categories","getOne","id","wine","getAll","query","wines","getLatest","create","update","deleteOne","getUser","user","register","login","logout","updateUser","addFavorite","userId","wineId","removeFavorite","getFavorites","favorites","guestUser","_id","_createdAt","_updatedAt","_isAdmin","firstName","lastName","email","phone","address","orders","cart","initialState","isLoading","status","errors","verify","createAsyncThunk","_","rejectWithValue","userService","message","userReducer","createSlice","name","reducers","extraReducers","builder","addCase","pending","state","fulfilled","action","payload","rejected","reducer","selectUser","cartSlice","set","add","subtract","Math","max","remove","reset","selectCart","actions","cartReducer","addItem","dispatch","getState","localStorage","setItem","error","console","ProductCard","product","navigate","useNavigate","useDispatch","useSelector","favoriteClickHandler","event","stopPropagation","includes","favorite","onClick","className","brand","src","image","alt","grape","join","year","country","isPromo","basePrice","toLocaleString","style","currency","currentPrice","toast","success","CheckboxGroup","category","fields","checkboxHandler","useState","isOpen","setIsOpen","useEffect","isSelected","Object","values","some","entries","map","field","htmlFor","type","value","checked","onChange","RangeGroup","filters","min","range","rangeHandler","minRange","maxRange","left","right","omitFilters","Filters","handlers","closeOnInput","handler","content","filter","onSubmit","filtersSubmitHandler","minPrice","maxPrice","priceRange","minYear","maxYear","yearRange","filtersResetHandler","Paginator","products","count","perPage","sort","page","ceil","Loader","initialFilters","region","volume","initialPaginate","Catalogue","setFilters","setProducts","useSearchParams","searchParams","setSearchParams","setIsLoading","parseQueryString","useCallback","queryString","keys","reduce","c","getFilters","wineService","selected","loadedFilters","acc","Boolean","toString","Number","currentFilters","getProducts","has","result","pages","replace","target","updatedFilter","prevState","updatedFilters","newState","ranges","newValue","mapFiltersToQuerystring","selectedFilters","length","preventDefault","paginationHandler","menuItems","title","mobileOnly","Header","mainRef","isScrolled","setIsScrolled","itemCount","main","current","mainObserver","IntersectionObserver","isIntersecting","root","threshold","rootMargin","observe","unobserve","navLinks","closeMenu","i","l","isActive","to","IconBadge","children","carouselContent","text","link","Slide","Carousel","currentIndex","setCurrentIndex","nextSlide","currentSlide","interval","setInterval","clearInterval","slides","slide","index","ProductsShowcase","setProduct","key","encodeURIComponent","log","Home","Footer","href","Auth","useIsAuth","location","useLocation","element","from","useIsGuest","pathname","isTouchedError","formik","touched","Required","initialValues","password","Login","isGuest","useFormik","unwrap","forEach","err","validationSchema","yup","required","disabled","isValid","isSubmitting","dirty","isError","bind","handleSubmit","placeholder","getFieldProps","repeatPassword","Register","oneOf","Logout","logoutOnLoad","CartContext","createContext","Cart","cartDetails","setCatDetails","cartTotal","itemTotal","toFixed","details","quantity","URLSearchParams","append","loadCartDetails","Provider","User","isAuth","getOrder","order","createOrder","getOrders","Profile","setOrders","setIsActive","loadOrders","orderSummary","items","Date","toLocaleDateString","Checkout","useContext","orderData","recipient","price","itemSummary","CartItem","ordered","quantityButtonClickHandler","currentTarget","removeItem","Summary","Favorites","setFavorites","getUserFavorites","favoritesDetails","f","Modal","targetRef","createRef","ModalContext","modalState","closeModal","disableBodyScroll","clearAllBodyScrollLocks","onChoice","choice","callback","active","ref","undefined","ModalProvider","setModalState","createModal","Details","useParams","setWine","DeleteClickHandler","confirmed","getDetails","description","Admin","useIsAdmin","isAdmin","FileDropzone","files","setFiles","useField","meta","helpers","onDrop","accFiles","rejFiles","normalizedAcc","file","assign","preview","URL","createObjectURL","setValue","setTouched","determineClasses","isDragActive","classes","push","useDropzone","accept","maxFiles","maxSize","multiple","getRootProps","getInputProps","fw","path","updated","curr","code","discountPercentage","moreThan","Create","formData","k","v","Array","isArray","component","form","rows","Error","isNewImage","when","is","then","Edit","updatedWine","loadWine","enableReinitialize","setFieldValue","Dashboard","loaded","OrderDetails","orderId","setOrder","loadOrder","App","useRef","getItem","parse","store","configureStore","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8327dc65.chunk.js","sourcesContent":["export const endpoint = 'http://localhost:5000/api';\r\n\r\nasync function request(url, options) {\r\n    try {\r\n        const response = await fetch(url, options);\r\n\r\n        if (response.ok === false) {\r\n            const error = await response.json();\r\n            throw error;\r\n        }\r\n\r\n        try {\r\n            return await response.json();\r\n        } catch {\r\n            return null;\r\n        }\r\n\r\n    } catch (error) {\r\n        throw error;\r\n    }\r\n}\r\n\r\nfunction createOptions(method = 'GET', data) {\r\n    const options = {\r\n        method,\r\n        credentials: 'include',\r\n        headers: {}\r\n    };\r\n    if (data) {\r\n        if (data instanceof FormData) {\r\n            options.body = data;\r\n        } else {\r\n            options.headers['Content-Type'] = 'application/json';\r\n            options.body = JSON.stringify(data);\r\n        }\r\n\r\n    }\r\n    return options;\r\n}\r\n\r\nexport async function get(url) {\r\n    return await request(url, createOptions());\r\n}\r\n\r\nexport async function post(url, data) {\r\n    return await request(url, createOptions('POST', data));\r\n}\r\n\r\nexport async function put(url, data) {\r\n    return await request(url, createOptions('PUT', data));\r\n}\r\n\r\nexport async function patch(url, data) {\r\n    return await request(url, createOptions('PATCH', data));\r\n}\r\n\r\nexport async function del(url) {\r\n    return await request(url, createOptions('DELETE'));\r\n}","import * as http from './http';\r\n\r\nconst endpoint = http.endpoint + '/wine';\r\n\r\nexport async function getCategories() {\r\n    const categories = await http.get(endpoint + '/categories');\r\n    return categories;\r\n}\r\n\r\nexport async function getOne(id) {\r\n    const wine = await http.get(endpoint + '/' + id);\r\n    return wine;\r\n}\r\n\r\nexport async function getAll(query) {\r\n    const wines = await http.get(endpoint + '?' + query);\r\n    return wines;\r\n}\r\n\r\nexport async function getLatest(query) {\r\n    const wines = await http.get(endpoint + '/latest?' + query);\r\n    return wines;\r\n}\r\n\r\nexport async function create(data) {\r\n    const wines = await http.post(endpoint, data);\r\n    return wines;\r\n}\r\n\r\nexport async function update(id, data) {\r\n    const wines = await http.put(endpoint + '/' + id, data);\r\n    return wines;\r\n}\r\n\r\nexport async function deleteOne(id) {\r\n    http.del(endpoint + '/' + id);\r\n}","import * as http from './http';\r\n\r\nconst endpoint = http.endpoint + '/user';\r\n\r\nexport async function getUser() {\r\n    const user = await http.get(endpoint);\r\n    return user;\r\n}\r\n\r\nexport async function register(data) {\r\n    const user = await http.post(endpoint + '/register', data);\r\n    return user;\r\n}\r\n\r\nexport async function login(data) {\r\n    const user = await http.post(endpoint + '/login', data);\r\n    return user;\r\n}\r\n\r\nexport async function logout() {\r\n    const user = await http.get(endpoint + '/logout');\r\n    return user;\r\n}\r\n\r\nexport async function updateUser(data) {\r\n    const user = await http.patch(endpoint, data);\r\n    return user;\r\n}\r\n\r\nexport async function addFavorite(userId, wineId) {\r\n    const user = await http.post(endpoint + `/${userId}/favorites/`, {wineId});\r\n    return user;\r\n}\r\n\r\nexport async function removeFavorite(userId, wineId) {\r\n    const user = await http.del(endpoint + `/${userId}/favorites/${wineId}`);\r\n    return user;\r\n};\r\n\r\nexport async function getFavorites(userId) {\r\n    const favorites = await http.get(endpoint + `/${userId}/favorites/`);\r\n    return favorites;\r\n}","import * as userService from '../../services/userService';\r\nimport {createAsyncThunk, createSlice} from '@reduxjs/toolkit';\r\n\r\nconst guestUser = {\r\n    _id: '',\r\n    _createdAt: '',\r\n    _updatedAt: '',\r\n    _isAdmin: false,\r\n    firstName: '',\r\n    lastName: '',\r\n    email: '',\r\n    phone: '',\r\n    address: '',\r\n    orders: [],\r\n    favorites: [],\r\n    cart: [],\r\n};\r\n\r\nconst initialState = {\r\n    isLoading: false,\r\n    status: 'idle',\r\n    user: guestUser,\r\n    errors: [],\r\n};\r\n\r\n\r\nexport const verify = createAsyncThunk('user/verify', async (_, {rejectWithValue}) => {\r\n    try {\r\n        const user = await userService.getUser();\r\n        return user;\r\n    } catch (error) {\r\n        return rejectWithValue(error.message);\r\n    }\r\n});\r\nexport const login = createAsyncThunk('user/login', async (data, {rejectWithValue}) => {\r\n    try {\r\n        const user = await userService.login(data);\r\n        return user;\r\n    } catch (error) {\r\n        return rejectWithValue(error.message);\r\n    }\r\n});\r\nexport const register = createAsyncThunk('user/register', async (data, {rejectWithValue}) => {\r\n    try {\r\n        const user = await userService.register(data);\r\n        return user;\r\n    } catch (error) {\r\n        return rejectWithValue(error.message);\r\n    }\r\n});\r\nexport const logout = createAsyncThunk('user/logout', async (_, {rejectWithValue}) => {\r\n    try {\r\n        const user = await userService.logout();\r\n        return user;\r\n    } catch (error) {\r\n        return rejectWithValue(error.message);\r\n    }\r\n});\r\nexport const addFavorite = createAsyncThunk('user/addFavorite', async ({userId, wineId}, {rejectWithValue}) => {\r\n    try {\r\n        const user = await userService.addFavorite(userId, wineId);\r\n        return user;\r\n    } catch (error) {\r\n        return rejectWithValue(error.message);\r\n    }\r\n});\r\nexport const removeFavorite = createAsyncThunk('user/removeFavorite', async ({userId, wineId}, {rejectWithValue}) => {\r\n    try {\r\n        const user = await userService.removeFavorite(userId, wineId);\r\n        return user;\r\n    } catch (error) {\r\n        return rejectWithValue(error.message);\r\n    }\r\n});\r\nexport const update = createAsyncThunk('user/update', async (data, {rejectWithValue}) => {\r\n    try {\r\n        const user = await userService.updateUser(data);\r\n        return user;\r\n    } catch (error) {\r\n        return rejectWithValue(error.message);\r\n    }\r\n});\r\n\r\nexport const userSlice = createSlice({\r\n    name: 'user',\r\n    initialState,\r\n    reducers: {},\r\n    extraReducers(builder) {\r\n        //  VERIFY\r\n        builder\r\n            .addCase(verify.pending, (state) => {\r\n                state.status = 'loading';\r\n                state.errors = [];\r\n            })\r\n            .addCase(verify.fulfilled, (state, action) => {\r\n                state.status = 'succeeded';\r\n                if (action.payload) {\r\n                    state.user = action.payload;\r\n                    state.errors = [];\r\n                }\r\n            })\r\n            .addCase(verify.rejected, (state, action) => {\r\n                state.status = 'failed';\r\n                state.errors = action.payload;\r\n            });\r\n        //  LOGIN\r\n        builder\r\n            .addCase(login.pending, (state) => {\r\n                state.status = 'loading';\r\n                state.errors = [];\r\n            })\r\n            .addCase(login.fulfilled, (state, action) => {\r\n                state.status = 'succeeded';\r\n                if (action.payload) {\r\n                    state.user = action.payload;\r\n                    state.errors = [];\r\n                }\r\n            })\r\n            .addCase(login.rejected, (state, action) => {\r\n                state.status = 'failed';\r\n                state.errors = action.payload;\r\n            });\r\n        //  REGISTER\r\n        builder\r\n            .addCase(register.pending, (state) => {\r\n                state.status = 'loading';\r\n                state.errors = [];\r\n            })\r\n            .addCase(register.fulfilled, (state, action) => {\r\n                state.status = 'succeeded';\r\n                if (action.payload) {\r\n                    state.user = action.payload;\r\n                    state.errors = [];\r\n                }\r\n            })\r\n            .addCase(register.rejected, (state, action) => {\r\n                state.status = 'failed';\r\n                state.errors = action.payload;\r\n            });\r\n        //  LOGOUT\r\n        builder\r\n            .addCase(logout.pending, (state) => {\r\n                state.status = 'loading';\r\n                state.errors = [];\r\n            })\r\n            .addCase(logout.fulfilled, (state, action) => {\r\n                state.status = 'succeeded';\r\n                state.user = guestUser;\r\n                state.errors = [];\r\n            })\r\n            .addCase(logout.rejected, (state, action) => {\r\n                state.status = 'failed';\r\n                state.errors = action.payload;\r\n            });\r\n        //  ADD FAVORITE\r\n        builder\r\n            .addCase(addFavorite.pending, (state) => {\r\n                state.status = 'loading';\r\n                state.errors = [];\r\n            })\r\n            .addCase(addFavorite.fulfilled, (state, action) => {\r\n                state.status = 'succeeded';\r\n                if (action.payload) {\r\n                    state.user = action.payload;\r\n                    state.errors = [];\r\n                }\r\n            })\r\n            .addCase(addFavorite.rejected, (state, action) => {\r\n                state.status = 'failed';\r\n                state.errors = action.payload;\r\n            });\r\n        //  REMOVE FAVORITE\r\n        builder\r\n            .addCase(removeFavorite.pending, (state) => {\r\n                state.status = 'loading';\r\n                state.errors = [];\r\n            })\r\n            .addCase(removeFavorite.fulfilled, (state, action) => {\r\n                state.status = 'succeeded';\r\n                if (action.payload) {\r\n                    state.user = action.payload;\r\n                    state.errors = [];\r\n                }\r\n            })\r\n            .addCase(removeFavorite.rejected, (state, action) => {\r\n                state.status = 'failed';\r\n                state.errors = action.payload;\r\n            });\r\n        //  UPDATE\r\n        builder\r\n            .addCase(update.pending, (state) => {\r\n                state.status = 'loading';\r\n                state.errors = [];\r\n            })\r\n            .addCase(update.fulfilled, (state, action) => {\r\n                state.status = 'succeeded';\r\n                if (action.payload) {\r\n                    state.user = action.payload;\r\n                    state.errors = [];\r\n                }\r\n            })\r\n            .addCase(update.rejected, (state, action) => {\r\n                state.status = 'failed';\r\n                state.errors = action.payload;\r\n            });\r\n    }\r\n});\r\n\r\nexport const userReducer = userSlice.reducer;\r\n\r\nexport const selectUser = (state) => state.user;","import {createSlice} from '@reduxjs/toolkit';\r\n\r\nconst initialState = {};\r\n\r\nexport const cartSlice = createSlice({\r\n    name: 'cart',\r\n    initialState,\r\n    reducers: {\r\n        set: (state, action) => {\r\n            const cart = action.payload || initialState;\r\n            return cart;\r\n        },\r\n        add: (state, action) => {\r\n            const wineId = action.payload;\r\n            state[wineId] = (state[wineId] || 0) + 1;\r\n        },\r\n        subtract: (state, action) => {\r\n            const wineId = action.payload;\r\n            state[wineId] = Math.max(1, state[wineId] - 1);\r\n        },\r\n        remove: (state, action) => {\r\n            const wineId = action.payload;\r\n            delete state[wineId];\r\n        },\r\n        reset: (state) => initialState,\r\n    }\r\n});\r\n\r\nexport const selectCart = (state) => state.cart;\r\n\r\nexport const {set, add, subtract, remove, reset} = cartSlice.actions;\r\n\r\nexport const cartReducer = cartSlice.reducer;\r\n\r\nexport const loadCart = () => {\r\n    return (dispatch) => {\r\n        try {\r\n            const content = localStorage.getItem('cart');\r\n            if (content) {\r\n                let cart = JSON.parse(content);\r\n                dispatch(set(cart));\r\n            } else {\r\n                localStorage.setItem('cart', '{}');\r\n            }\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n};\r\n\r\nexport const addItem = (wineId) => {\r\n    return (dispatch, getState) => {\r\n        try {\r\n            dispatch(add(wineId));\r\n            localStorage.setItem('cart', JSON.stringify(getState().cart));\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n};\r\n\r\nexport const subtractItem = (wineId) => {\r\n    return (dispatch, getState) => {\r\n        try {\r\n            dispatch(subtract(wineId));\r\n            localStorage.setItem('cart', JSON.stringify(getState().cart));\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n};\r\n\r\nexport const removeItem = (wineId) => {\r\n    return (dispatch, getState) => {\r\n        try {\r\n            dispatch(remove(wineId));\r\n            localStorage.setItem('cart', JSON.stringify(getState().cart));\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n};\r\n\r\nexport const resetCart = () => {\r\n    return (dispatch, getState) => {\r\n        try {\r\n            dispatch(reset());\r\n            localStorage.setItem('cart', JSON.stringify(initialState));\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n};","import './ProductCard.scss';\r\nimport {Link, useNavigate} from 'react-router-dom';\r\nimport {FaStar, FaRegStar} from 'react-icons/fa';\r\nimport {useSelector} from 'react-redux';\r\nimport {addFavorite, removeFavorite, selectUser} from '../../../store/slices/userSlice';\r\nimport {useDispatch} from 'react-redux';\r\nimport {addItem} from '../../../store/slices/cartSlice';\r\nimport {toast} from 'react-toastify';\r\n\r\nexport function ProductCard({product}) {\r\n    const navigate = useNavigate();\r\n    const dispatch = useDispatch();\r\n    const {user} = useSelector(selectUser);\r\n\r\n    function navigateToDetails() {\r\n        navigate(`/details/${product._id}`);\r\n    }\r\n\r\n    function favoriteClickHandler(event) {\r\n        event.stopPropagation();\r\n        user?.favorites.includes(product?._id)\r\n            ? dispatch(removeFavorite({userId: user._id, wineId: product._id}))\r\n            : dispatch(addFavorite({userId: user._id, wineId: product._id}));\r\n    }\r\n\r\n    function addToCartClickHandler() {\r\n        dispatch(addItem(product._id));\r\n        toast.success('Wine added to cart');\r\n\r\n    }\r\n\r\n    const favorite = user.favorites.includes(product?._id)\r\n        ? <FaStar onClick={favoriteClickHandler} />\r\n        : <FaRegStar onClick={favoriteClickHandler} />;\r\n\r\n    return (\r\n        <article className=\"product-card\" >\r\n\r\n            <div className=\"card-main\" onClick={navigateToDetails}>\r\n\r\n                <header className=\"card-header\" >\r\n                    <div className=\"spacer\"></div>\r\n                    <p className=\"brand\">{product.brand}</p>\r\n                    {user._id && !user._isAdmin && <div className=\"favorite-icon-container\">{favorite}</div>}\r\n                </header>\r\n\r\n                <div className=\"image-container\">\r\n                    <img src={product.image} alt=\"product\" />\r\n                </div>\r\n\r\n                <div className=\"product-details\">\r\n                    <p className=\"name\">{product.name}</p>\r\n                    <p className=\"grapes\">{product.grape.join(' ,')}</p>\r\n                    <div className=\"geo\">\r\n                        <span className=\"year\">{product.year}</span> | <span className=\"country\">{product.country}</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"prices\">\r\n                    {product.isPromo\r\n                        ? <p className=\"price\">\r\n                            <span className=\"old-price\">{product.basePrice.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span>\r\n                            <span className=\"current-price\">{product.currentPrice.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span>\r\n                        </p>\r\n                        : <p><span className=\"base-price\">{product.currentPrice.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span></p>\r\n                    }\r\n                </div>\r\n\r\n                {product.isPromo && <span className=\"sale-logo\">great deal!</span>}\r\n\r\n            </div>\r\n\r\n            {!user._isAdmin\r\n                ? <div className=\"buttons\">\r\n                    <button className=\"action-button\" onClick={addToCartClickHandler}>Add to cart</button>\r\n                </div>\r\n                : null\r\n            }\r\n\r\n        </article>\r\n    );\r\n}","import './FormGroup.scss';\r\nimport {useEffect, useState} from 'react';\r\nimport {FaChevronDown, FaChevronUp} from 'react-icons/fa';\r\n\r\nexport function CheckboxGroup({category, fields, checkboxHandler}) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const isSelected = Object.values(fields).some(status => status);\r\n        setIsOpen(isSelected);\r\n    }, [fields]);\r\n\r\n    useEffect(() => {\r\n        setIsOpen(() => Object.values(fields).some(status => status));\r\n    }, [fields]);\r\n\r\n    function toggleOpen() {\r\n        setIsOpen(isOpen => !isOpen);\r\n    }\r\n\r\n    return (\r\n        <div className=\"filter-group\">\r\n            <div className=\"filter-group-header\" onClick={toggleOpen}>\r\n                <h5 className=\"filter-group-heading\" >{category}</h5>\r\n                {isOpen ? <FaChevronUp /> : <FaChevronDown />}\r\n            </div>\r\n            <div className={isOpen ? 'filter-group-content active' : 'filter-group-content'}>\r\n                {Object.entries(fields).map(([field, status]) => (\r\n                    <div className=\"check-group\" key={field}>\r\n                        <label htmlFor={field}>{field}\r\n                            <input type=\"checkbox\" id={field} name={field} value={field} checked={status} onChange={(event) => checkboxHandler(event, category)} />\r\n                            <span className=\"checkMark\"></span>\r\n                        </label>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n}","import './FormGroup.scss';\r\nimport {useEffect, useState} from 'react';\r\nimport {FaChevronDown, FaChevronUp} from 'react-icons/fa';\r\n\r\nexport function RangeGroup({filters, name, min, max, range, rangeHandler}) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const minRange = range.min;\r\n    const maxRange = range.max;\r\n    let left = ((min - minRange) / (maxRange - minRange) * 100) * 0.98 + '%';\r\n    let right = ((maxRange - max) / (maxRange - minRange) * 100) * 0.98 + '%';\r\n\r\n    useEffect(() => {\r\n        setIsOpen(() => (min !== minRange) || (max !== maxRange));\r\n    }, [max, maxRange, min, minRange, filters]);\r\n\r\n    function toggleOpen() {\r\n        setIsOpen(isOpen => !isOpen);\r\n    }\r\n\r\n    return (\r\n        <div className=\"filter-group range-group\">\r\n            <div className=\"filter-group-header\" onClick={toggleOpen}>\r\n                <h5 className=\"filter-group-heading\" >{name}</h5>\r\n                {isOpen ? <FaChevronUp /> : <FaChevronDown />}\r\n            </div>\r\n            <div className={isOpen ? 'filter-group-content active' : 'filter-group-content'}>\r\n\r\n                <div className=\"selection\">\r\n                    <div >Between: <span className={name}>{min}</span> - <span className={name}>{max}</span></div>\r\n                </div>\r\n                <div className=\"slider-container\">\r\n                    <input type=\"range\" id=\"input-left\" name={`min${name}`} min={minRange} max={maxRange} value={min} onChange={rangeHandler} />\r\n                    <input type=\"range\" id=\"input-right\" name={`max${name}`} min={minRange} max={maxRange} value={max} onChange={rangeHandler} />\r\n\r\n                    <div className=\"slider\">\r\n                        <div className=\"track\"></div>\r\n                        <div className=\"range\" style={{left, right}}></div>\r\n                        <div className=\"thumb left\" style={{left}}></div>\r\n                        <div className=\"thumb right\" style={{right}}></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}","import './Filters.scss';\r\nimport {CheckboxGroup} from './CheckboxGroup';\r\nimport {RangeGroup} from './RangeGroup';\r\nimport {useState} from 'react';\r\nimport {FaChevronDown, FaChevronUp} from 'react-icons/fa';\r\n\r\nconst omitFilters = ['minYear', 'maxYear', 'yearRange', 'minPrice', 'maxPrice', 'priceRange', 'page', 'perPage', 'sort'];\r\n\r\nexport function Filters({filters, handlers}) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n\r\n    function toggleOpen() {\r\n        setIsOpen(isOpen => !isOpen);\r\n    }\r\n\r\n    function closeOnInput(handler) {\r\n        return function (event) {\r\n            setIsOpen(false);\r\n            handler(event);\r\n        };\r\n    }\r\n\r\n    const content = Object.entries(filters)\r\n        .filter(([category]) => !(omitFilters.includes(category)))\r\n        .map(([category, fields]) => <CheckboxGroup key={category} category={category} fields={fields} checkboxHandler={handlers.checkboxHandler} />);\r\n\r\n    return (\r\n        <section className=\"filters\">\r\n            <div className=\"section-header\" onClick={toggleOpen}>\r\n                <h4 className=\"heading\">Filters</h4>\r\n                {isOpen ? <FaChevronUp /> : <FaChevronDown />}\r\n            </div>\r\n            <form className={isOpen ? 'filter-form active' : 'filter-form'} onSubmit={closeOnInput(handlers.filtersSubmitHandler)} >\r\n                <div className=\"filters-groups-container\">\r\n                    <RangeGroup rangeHandler={handlers.rangeHandler} min={filters.minPrice} max={filters.maxPrice} range={filters.priceRange} name=\"Price\" filters={filters} />\r\n                    <RangeGroup rangeHandler={handlers.rangeHandler} min={filters.minYear} max={filters.maxYear} range={filters.yearRange} name=\"Year\" filters={filters} />\r\n                    {content}\r\n                </div>\r\n                <div className=\"buttons\">\r\n                    <button className=\"button reset\" onClick={closeOnInput(handlers.filtersResetHandler)} type=\"button\" >Reset</button>\r\n                    <input className=\"button submit\" type=\"submit\" value=\"Apply\" />\r\n                </div>\r\n            </form>\r\n\r\n        </section >\r\n    );\r\n}","import {FaChevronLeft, FaChevronRight} from 'react-icons/fa';\r\nimport './Paginator.scss';\r\n\r\n\r\nexport function Paginator({handler, products}) {\r\n    const content = products.count\r\n        ? (\r\n            <div className=\"paginator\" >\r\n                <div className=\"selector-group per-page\">\r\n                    <label htmlFor=\"perPage\">Items per page</label>\r\n                    <select name=\"perPage\" id=\"perPage\" onChange={handler} value={products.perPage}>\r\n                        <option value=\"12\">12</option>\r\n                        <option value=\"24\">24</option>\r\n                        <option value=\"36\">36</option>\r\n                    </select>\r\n                </div>\r\n                <div className=\"selector-group sort\">\r\n                    <label htmlFor=\"sort\">Sorting</label>\r\n                    <select name=\"sort\" id=\"sort\" onChange={handler} value={products.sort}>\r\n                        <option value=\"-_isPromo\">Best Deals</option>\r\n                        <option value=\"-_createdAt\">Latest Products</option>\r\n                        <option value=\"-currentPrice\">Price Descending</option>\r\n                        <option value=\"currentPrice\">Price Ascending</option>\r\n                    </select>\r\n                </div>\r\n                <div className=\"selector-group page\">\r\n                    <div className=\"label\">\r\n                        Page:{products.page} of {Math.ceil(products.count / products.perPage)}\r\n                    </div>\r\n                    <div className=\"buttons\" onClick={handler}>\r\n                        <button className='select-page-button' id='previousPage' ><FaChevronLeft /></button>\r\n                        <button className='select-page-button' id='nextPage' ><FaChevronRight /></button>\r\n                    </div>\r\n                </div>\r\n            </div >\r\n        )\r\n        : null;\r\n\r\n    return content;\r\n}","export function Loader() {\r\n    return (\r\n        <p>Loading...</p>\r\n    );\r\n}","import './Catalogue.scss';\r\nimport {useEffect, useState} from 'react';\r\nimport * as wineService from '../../../services/wineService';\r\nimport {ProductCard} from '../../shared/ProductCard/ProductCard';\r\nimport {Filters} from './Filters';\r\nimport {useNavigate, useSearchParams} from 'react-router-dom';\r\nimport {useCallback} from 'react';\r\nimport {Paginator} from '../../shared/Paginator/Paginator';\r\nimport {Loader} from '../../shared/Loader/Loader';\r\n\r\nlet initialFilters = {\r\n    type: {},\r\n    brand: {},\r\n    grape: {},\r\n    country: {},\r\n    region: {},\r\n    volume: {},\r\n    priceRange: {min: 0, max: 1000},\r\n    minPrice: 0,\r\n    maxPrice: 1000,\r\n    yearRange: {min: 1900, max: 3000},\r\n    minYear: 1900,\r\n    maxYear: 3000,\r\n};\r\n\r\nlet initialPaginate = {\r\n    page: 1,\r\n    perPage: 12,\r\n    count: 0,\r\n    sort: '-isPromo'\r\n};\r\n\r\nexport function Catalogue() {\r\n    const [filters, setFilters] = useState(initialFilters);\r\n    const [products, setProducts] = useState({wines: [], ...initialPaginate});\r\n    const [searchParams, setSearchParams] = useSearchParams();\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const navigate = useNavigate();\r\n\r\n    const parseQueryString = useCallback((queryString) => {\r\n        const keys = [...queryString.keys()];\r\n        const result = keys.reduce((a, c) => {\r\n            a[c] = queryString.getAll(c);\r\n            return a;\r\n        }, {});\r\n        return result;\r\n    }, []);\r\n\r\n    const getFilters = useCallback(async (searchParams) => {\r\n        const categories = await wineService.getCategories();\r\n        const selected = parseQueryString(searchParams);\r\n        const omitFilters = ['minYear', 'maxYear', 'yearRange', 'minPrice', 'maxPrice', 'priceRange', 'isPromo'];\r\n\r\n        const loadedFilters = Object.entries(categories)\r\n            .filter(([category]) => !(omitFilters.includes(category)))\r\n            .reduce((acc, [category, fields]) => {\r\n                acc[category] = fields.reduce((a, c) => {\r\n                    a[c] = Boolean(selected[category]?.includes(c.toString()));\r\n                    return a;\r\n                }, {});\r\n\r\n                return acc;\r\n            }, {});\r\n\r\n        loadedFilters.minPrice = (selected.minPrice && Number(selected.minPrice[0])) || categories.minPrice;\r\n        loadedFilters.maxPrice = (selected.maxPrice && Number(selected.maxPrice[0])) || categories.maxPrice;\r\n        loadedFilters.priceRange = {\r\n            min: categories.minPrice,\r\n            max: categories.maxPrice,\r\n        };\r\n\r\n        loadedFilters.minYear = (selected.minYear && Number(selected.minYear[0])) || categories.minYear;\r\n        loadedFilters.maxYear = (selected.maxYear && Number(selected.maxYear[0])) || categories.maxYear;\r\n        loadedFilters.yearRange = {\r\n            min: categories.minYear,\r\n            max: categories.maxYear,\r\n        };\r\n\r\n        initialFilters = loadedFilters;\r\n        setFilters(currentFilters => ({...currentFilters, ...loadedFilters}));\r\n\r\n    }, [parseQueryString]);\r\n\r\n    const getProducts = useCallback(async (searchParams) => {\r\n        const page = searchParams.has('page') && Number(searchParams.get('page'));\r\n        const result = await wineService.getAll(searchParams);\r\n        let pages = Math.ceil(result.count / result.perPage);\r\n        if (result.count && page > pages) {\r\n            searchParams.set('page', Math.min(page, pages));\r\n            setSearchParams(searchParams, {replace: true});\r\n        };\r\n        setProducts(() => result);\r\n        setIsLoading(false);\r\n    }, [setSearchParams]);\r\n\r\n    const checkboxHandler = useCallback((event, category) => {\r\n        const name = event.target.name;\r\n        const checked = event.target.checked;\r\n        const updatedFilter = {[name]: checked};\r\n\r\n        setFilters(prevState => {\r\n            const filters = prevState[category];\r\n            const updatedFilters = {...filters, ...updatedFilter};\r\n            const newState = {...prevState};\r\n            newState[category] = updatedFilters;\r\n            return newState;\r\n        });\r\n    }, []);\r\n\r\n    const rangeHandler = useCallback((event) => {\r\n        const name = event.target.name;\r\n\r\n        setFilters(prevState => {\r\n            const ranges = {\r\n                minPrice: prevState.minPrice,\r\n                maxPrice: prevState.maxPrice,\r\n                minYear: prevState.minYear,\r\n                maxYear: prevState.maxYear,\r\n            };\r\n            const newValue = Number(event.target.value);\r\n\r\n            if (name === 'minPrice') {\r\n                ranges.minPrice = Math.min(ranges.maxPrice - 10, newValue);\r\n            } else if (name === 'maxPrice') {\r\n                ranges.maxPrice = Math.max(ranges.minPrice + 10, newValue);\r\n            } else if (name === 'minYear') {\r\n                ranges.minYear = Math.min(ranges.maxYear - 1, newValue);\r\n            } else if (name === 'maxYear') {\r\n                ranges.maxYear = Math.max(ranges.minYear + 1, newValue);\r\n            }\r\n\r\n            return {...prevState, ...ranges};\r\n        });\r\n    }, []);\r\n\r\n    const filtersResetHandler = useCallback(() => {\r\n        setSearchParams();\r\n        try {\r\n            getFilters(searchParams);\r\n        } catch (error) {\r\n            navigate('/error');\r\n        }\r\n    }, [getFilters, navigate, searchParams, setSearchParams]);\r\n\r\n    const mapFiltersToQuerystring = useCallback(() => {\r\n        const omitFilters = ['minYear', 'maxYear', 'yearRange', 'minPrice', 'maxPrice', 'priceRange', 'isPromo'];\r\n        const selectedFilters = Object.entries(filters)\r\n            .filter(([category]) => !(omitFilters.includes(category)))\r\n            .reduce((acc, [category, fields]) => {\r\n                const checked = Object.keys(fields).filter(field => fields[field]);\r\n                if (Object.keys(checked).length > 0) {acc[category] = checked;}\r\n                return acc;\r\n            }, {});\r\n\r\n        if ((searchParams.has('minPrice') && searchParams.get('minPrice') !== filters.minPrice) || (filters.minPrice !== initialFilters.minPrice)) {\r\n            selectedFilters.minPrice = filters.minPrice;\r\n        }\r\n        if ((searchParams.has('maxPrice') && searchParams.get('maxPrice') !== filters.maxPrice) || (filters.maxPrice !== initialFilters.maxPrice)) {\r\n            selectedFilters.maxPrice = filters.maxPrice;\r\n        }\r\n        if ((searchParams.has('minYear') && searchParams.get('minYear') !== filters.minYear) || (filters.minYear !== initialFilters.minYear)) {\r\n            selectedFilters.minYear = filters.minYear;\r\n        }\r\n        if ((searchParams.has('maxYear') && searchParams.get('maxYear') !== filters.maxYear) || (filters.maxYear !== initialFilters.maxYear)) {\r\n            selectedFilters.maxYear = filters.maxYear;\r\n        }\r\n\r\n        setSearchParams(selectedFilters);\r\n    }, [filters, searchParams, setSearchParams]);\r\n\r\n    const filtersSubmitHandler = useCallback((event) => {\r\n        event.preventDefault();\r\n        mapFiltersToQuerystring();\r\n    }, [mapFiltersToQuerystring]);\r\n\r\n\r\n    const paginationHandler = useCallback((event) => {\r\n        let page = products.page;\r\n        let perPage = products.perPage;\r\n        let sort = products.sort;\r\n\r\n        if (event.target.id === 'previousPage') {\r\n            page = Math.max(products.page - 1, 1);\r\n        } else if (event.target.id === 'nextPage') {\r\n            page = Math.min(products.page + 1, Math.ceil(products.count / products.perPage));\r\n        } else if (event.target.id === 'perPage') {\r\n            perPage = Number(event.target.value);\r\n        } else if (event.target.id === 'sort') {\r\n            sort = (event.target.value);\r\n        }\r\n\r\n        if (page !== products.page) {\r\n            searchParams.set('page', page);\r\n            setSearchParams(parseQueryString(searchParams));\r\n        }\r\n        if (perPage !== products.perPage) {\r\n            searchParams.set('page', 1);\r\n            searchParams.set('perPage', perPage);\r\n            setSearchParams(parseQueryString(searchParams));\r\n        }\r\n        if (sort !== products.sort) {\r\n            searchParams.set('page', 1);\r\n            searchParams.set('sort', sort);\r\n            setSearchParams(parseQueryString(searchParams));\r\n        }\r\n\r\n    }, [parseQueryString, products.count, products.page, products.perPage, products.sort, searchParams, setSearchParams]);\r\n\r\n    useEffect(() => {\r\n        try {\r\n            getFilters(searchParams);\r\n            getProducts(searchParams);\r\n        } catch (error) {\r\n            navigate('/error');\r\n        }\r\n    }, [getFilters, getProducts, navigate, searchParams]);\r\n\r\n    const content = products.count\r\n        ? products.wines.map(product => <ProductCard key={product._id} product={product} />)\r\n        : <div className=\"no-results\"><p>No wines meet the specified criteria.</p> <p>Please refine your filters.</p></div>;\r\n\r\n    return (\r\n        <section className=\"page catalogue container\">\r\n            <h1 className=\"page-title\">Wine Catalogue</h1>\r\n\r\n            {isLoading ? null : <Filters filters={filters} handlers={{checkboxHandler, rangeHandler, filtersSubmitHandler, filtersResetHandler}} />}\r\n\r\n            {isLoading ? null : <Paginator handler={paginationHandler} products={products} />}\r\n\r\n            <div className=\"products-container\">\r\n                {isLoading\r\n                    ? <Loader />\r\n                    : content\r\n                }\r\n            </div>\r\n\r\n        </section>\r\n    );\r\n};;","export const menuItems = [\r\n    {\r\n        title: 'Catalogue',\r\n        url: '/catalogue',\r\n        type: 'public',\r\n        mobileOnly: false,\r\n    },\r\n    {\r\n        title: 'Favorites',\r\n        url: '/user/favorites',\r\n        type: 'public',\r\n        mobileOnly: true,\r\n    },\r\n    {\r\n        title: 'Profile',\r\n        url: '/user/profile',\r\n        type: 'user',\r\n        mobileOnly: true,\r\n    },\r\n    {\r\n        title: 'Contacts',\r\n        url: '/contacts',\r\n        type: 'user',\r\n        mobileOnly: false,\r\n    },\r\n    {\r\n        title: 'About us',\r\n        url: '/about',\r\n        type: 'user',\r\n        mobileOnly: false,\r\n    },\r\n    {\r\n        title: 'Login',\r\n        url: '/auth/login',\r\n        type: 'guest',\r\n        mobileOnly: false,\r\n    },\r\n    {\r\n        title: 'Register',\r\n        url: '/auth/register',\r\n        type: 'guest',\r\n        mobileOnly: false,\r\n    },\r\n    // {\r\n    //     title: 'Logout',\r\n    //     url: '/auth/logout',\r\n    //     type: 'user',\r\n    //     mobileOnly: true,\r\n    // },\r\n    {\r\n        title: 'Dashboard',\r\n        url: '/admin/dashboard',\r\n        type: 'admin',\r\n        mobileOnly: true,\r\n    },\r\n    {\r\n        title: 'Catalogue',\r\n        url: '/catalogue',\r\n        type: 'admin',\r\n        mobileOnly: false,\r\n    },\r\n    {\r\n        title: 'Create',\r\n        url: '/admin/create',\r\n        type: 'admin',\r\n        mobileOnly: false,\r\n    },\r\n    {\r\n        title: 'Profile',\r\n        url: '/user/profile',\r\n        type: 'admin',\r\n        mobileOnly: true,\r\n    },\r\n];","import './Header.scss';\r\nimport {Link, NavLink} from 'react-router-dom';\r\nimport {menuItems} from './menuItems';\r\nimport {BsCart2, BsList, BsX, BsPerson, BsStar} from 'react-icons/bs';\r\nimport {ImGlass} from 'react-icons/im';\r\nimport {useState} from 'react';\r\nimport {useSelector} from 'react-redux';\r\nimport {selectUser} from '../../store/slices/userSlice';\r\nimport {selectCart} from '../../store/slices/cartSlice';\r\nimport {useEffect} from 'react';\r\nimport {FaRegChartBar} from 'react-icons/fa';\r\n\r\nexport function Header({mainRef}) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [isScrolled, setIsScrolled] = useState(false);\r\n    const {user} = useSelector(selectUser);\r\n    const cart = useSelector(selectCart);\r\n    const itemCount = Object.values(cart).reduce((a, c) => a + c, 0);\r\n\r\n    useEffect(() => {\r\n        const main = mainRef.current;\r\n        const mainObserver = new IntersectionObserver(([main]) => {\r\n            setIsScrolled(!main.isIntersecting);\r\n        }, {\r\n            root: null,\r\n            threshold: 0,\r\n            rootMargin: '0px 0px -98% 0px'\r\n        });\r\n\r\n        mainObserver.observe(main);\r\n\r\n        return () => {mainObserver.unobserve(main);};\r\n\r\n    }, [mainRef]);\r\n\r\n    let navLinks = [];\r\n\r\n    if (user._id && user._isAdmin) {\r\n        navLinks = menuItems.filter(i => i.type === 'admin');\r\n    } else if (user._id) {\r\n        navLinks = menuItems.filter(i => (i.type === 'public' || i.type === 'user'));\r\n    } else {\r\n        navLinks = menuItems.filter(i => (i.type === 'public' || i.type === 'guest'));\r\n    }\r\n\r\n\r\n    function toggleMenu() {\r\n        setIsOpen(state => !state);\r\n    }\r\n\r\n    function closeMenu() {\r\n        setIsOpen(false);\r\n    }\r\n\r\n    return (\r\n        <header className={isScrolled ? 'site-header' : 'site-header scrolled'}>\r\n            < div className=\"container\">\r\n                <nav className=\"site-navigation\" >\r\n\r\n                    <div className=\"nav-button menu-icon\" ><button onClick={toggleMenu}>{isOpen ? <BsX /> : <BsList />}</button></div>\r\n                    <ul className=\"navigation-items\" onClick={closeMenu}>\r\n\r\n                        {navLinks.filter(l => !l.mobileOnly).map(i => <li className=\"nav-link\" key={i.title}><NavLink className={({isActive}) => isActive ? 'nav-active' : ''} to={i.url}>{i.title}</NavLink></li>)}\r\n                    </ul>\r\n\r\n                    <div className=\"site-logo\" onClick={closeMenu}><Link to=\"/\">Fine <ImGlass /> wine</Link></div>\r\n\r\n\r\n                    <div className=\"nav-button\" onClick={closeMenu}>\r\n                        {!user._isAdmin\r\n                            ?\r\n                            <>\r\n                                <div className=\"user-links\">\r\n                                    <Link className=\"nav-icon-link\" to=\"/user/favorites\"><BsStar /><IconBadge>{user.favorites.length}</IconBadge></Link>\r\n                                    <Link className=\"nav-icon-link\" to=\"/user/profile\"><BsPerson /></Link>\r\n                                </div>\r\n                                <Link className=\"nav-icon-link\" to=\"/cart\"><BsCart2 /><IconBadge>{itemCount}</IconBadge></Link>\r\n                            </>\r\n                            : <>\r\n                                <div className=\"user-links\">\r\n                                    <Link className=\"nav-icon-link\" to=\"/user/profile\"><BsPerson /></Link>\r\n                                </div>\r\n                                <Link className=\"nav-icon-link\" to=\"/admin/dashboard\"><FaRegChartBar /></Link>\r\n                            </>\r\n                        }\r\n                    </div>\r\n\r\n                </nav>\r\n\r\n                <div className={isOpen ? 'mobile-menu active' : 'mobile-menu'} onClick={closeMenu}>\r\n                    <ul className=\"mobile-menu-items\" >\r\n                        {navLinks.map(i => <li className=\"menu-link\" key={i.title}><Link to={i.url}>{i.title}</Link></li>)}\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        </header >\r\n    );\r\n}\r\n\r\nfunction IconBadge({children}) {\r\n    return (\r\n        children\r\n            ? <div className=\"icon-badge\"><span className=\"icon-badge-content\">{children}</span></div>\r\n            : null\r\n    );\r\n}","export const carouselContent = [\r\n    {\r\n        image: 'grapes.webp',\r\n        title: 'Get a taste of our exquisite ruby red wines selection',\r\n        text: 'Explore catalogue',\r\n        link: '/catalogue?type=red',\r\n    },\r\n    {\r\n        image: 'gold-grapes.webp',\r\n        title: 'Dive into an endless ocean of gold sensations',\r\n        text: 'Explore catalogue',\r\n        link: '/catalogue?type=white',\r\n    },\r\n    {\r\n        image: 'rose.webp',\r\n        title: 'Enjoy countless moments with our premium rose offering',\r\n        text: 'Explore catalogue',\r\n        link: '/catalogue?type=rose',\r\n    },\r\n    {\r\n        image: 'corks2.webp',\r\n        title: 'Make your celebrations truly special with our sparkling wines',\r\n        text: 'Explore catalogue',\r\n        link: '/catalogue?type=sparkling',\r\n    },\r\n    {\r\n        image: 'four-glasses.webp',\r\n        title: 'Find the best companion for your sweet desserts',\r\n        text: 'Explore catalogue',\r\n        link: '/catalogue?type=dessert',\r\n    },\r\n];","import {Link} from 'react-router-dom';\r\nimport './Slide.scss';\r\n\r\nexport function Slide({data}) {\r\n    return (\r\n        <div className=\"slide-container\" style={{'backgroundImage': `url('/images/${data.image}')`}}>\r\n            <h1 className=\"slide-title\">{data.title}</h1>\r\n            <Link className=\"slide-button\" to={data.link}>{data.text}</Link>\r\n        </div >\r\n    );\r\n}","import {carouselContent} from './carouselContent';\r\nimport './Carousel.scss';\r\nimport {useEffect, useState} from 'react';\r\nimport {Slide} from './Slide';\r\nimport {FaArrowCircleLeft, FaArrowCircleRight} from 'react-icons/fa';\r\n\r\nexport function Carousel() {\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n\r\n    useEffect(() => {\r\n        const interval = setInterval(() => {\r\n            nextSlide();\r\n        }, 7000);\r\n        return () => clearInterval(interval);\r\n    }, [currentIndex]);\r\n\r\n\r\n    function nextSlide() {\r\n        setCurrentIndex(\r\n            currentSlide => currentSlide + 1 === carouselContent.length\r\n                ? 0\r\n                : currentSlide + 1\r\n        );\r\n    }\r\n\r\n    function prevSlide() {\r\n        setCurrentIndex(\r\n            currentSlide => currentSlide - 1 < 0\r\n                ? carouselContent.length - 1\r\n                : currentSlide - 1\r\n        );\r\n    }\r\n\r\n    const slides = carouselContent.map((slide, index) => (\r\n        <div key={slide.image} className={index === currentIndex ? 'slide active' : 'slide'}>\r\n            {index === currentIndex && <Slide data={slide} />}\r\n        </div>\r\n    ));\r\n\r\n    return (\r\n        <div className=\"carousel\">\r\n            <FaArrowCircleLeft className=\"arrow left-arrow\" onClick={prevSlide} />\r\n            {slides}\r\n            <FaArrowCircleRight className=\"arrow right-arrow\" onClick={nextSlide} />\r\n        </div>\r\n    );\r\n}","import {useEffect} from 'react';\r\nimport {useState} from 'react';\r\nimport * as wineService from '../../../../services/wineService';\r\nimport {ProductCard} from '../../../shared/ProductCard/ProductCard';\r\nimport './ProductsShowcase.scss';\r\n\r\nexport function ProductsShowcase({query = {}, title = ''}) {\r\n    const [products, setProduct] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const queryString = Object.keys(query).map((key) => {\r\n        return encodeURIComponent(key) + '=' + encodeURIComponent(query[key]);\r\n    }).join('&');\r\n\r\n    useEffect(() => {\r\n        try {\r\n            getProducts();\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n\r\n        async function getProducts() {\r\n            const products = await wineService.getLatest(queryString);\r\n            setProduct(() => products);\r\n            setIsLoading(() => false);\r\n        }\r\n    }, [queryString]);\r\n\r\n    const content = (\r\n        isLoading\r\n            ? <p>Loading...</p>\r\n            : products.map(product => (<ProductCard key={product._id} product={product} />))\r\n    );\r\n\r\n    return (\r\n        <section className=\"products-showcase container\">\r\n            <header className=\"section-header\">\r\n                <h4>{title}</h4>\r\n            </header>\r\n            <div className=\"products-container\">\r\n                {content}\r\n            </div>\r\n        </section>\r\n    );\r\n}","import {Carousel} from './Carousel/Carousel';\r\nimport {ProductsShowcase} from './ProductShowcase/ProductsShowcase';\r\n\r\nexport function Home() {\r\n    return (\r\n        <>\r\n            <Carousel />\r\n            <ProductsShowcase query={{isPromo: true}} title=\"Best deals\" />\r\n            <ProductsShowcase title=\"Latest products\" />\r\n        </>\r\n    );\r\n}","import {Link} from 'react-router-dom';\r\nimport './Footer.scss';\r\nimport {FaFacebookF, FaTwitter, FaInstagram, FaYoutube} from \"react-icons/fa\";\r\n\r\nexport function Footer() {\r\n    return (\r\n        <footer className=\"site-footer\">\r\n            <div className=\"container\">\r\n                <div className=\"footer-group\">\r\n                    <h5><Link to=\"/\" />Fine wine</h5>\r\n                    <ul className=\"about-us\">\r\n                        <li><Link to=\"/about\">About us</Link></li>\r\n                        <li><Link to=\"/contacts\" >Contacts</Link></li>\r\n                        <li><Link to=\"/terms\" >Terms and conditions</Link></li>\r\n                    </ul>\r\n                </div>\r\n                <div className=\"footer-group\">\r\n                    <h5>Customer service</h5>\r\n                    <ul className=\"customer-service\">\r\n                        <li><a href=\"tel:+359010010101\">Phone: +359 010 010 101</a></li>\r\n                        <li> MON - FRI | 09:00 - 18:00</li>\r\n                    </ul>\r\n                </div>\r\n                <div className=\"footer-group\">\r\n                    <h5>Social Media</h5>\r\n                    <ul className=\"social-media\">\r\n                        <li><a href=\"http://www.youtube.com\"><FaYoutube /></a></li>\r\n                        <li><a href=\"http://www.instagram.com\"><FaInstagram /></a></li>\r\n                        <li><a href=\"http://www.twitter.com\"><FaTwitter /></a></li>\r\n                        <li><a href=\"http://www.facebook.com\"><FaFacebookF /></a></li>\r\n                    </ul>\r\n                </div>\r\n                <p className=\"copyright\">&copy;Demo app made for educational purposes. No rights reserved.</p>\r\n            </div>\r\n        </footer>\r\n    );\r\n}","import {Outlet} from 'react-router';\r\nimport {NavLink} from 'react-router-dom';\r\nimport './Auth.scss';\r\n\r\nexport function Auth() {\r\n    function className({isActive}) {\r\n        return isActive ? 'auth-link active' : 'auth-link';\r\n    };\r\n\r\n    return (\r\n        <section className='auth-page container' >\r\n            <header className=\"section-header\">\r\n                <ul className=\"auth-link-list\">\r\n                    <li className=\"auth-link-list-item\"><NavLink className={className} replace={true} to=\"/auth/login\">Login</NavLink></li>\r\n                    <li className=\"auth-link-list-item active\"><NavLink className={className} replace={true} to=\"/auth/register\">Register</NavLink></li>\r\n                </ul>\r\n            </header>\r\n\r\n            <Outlet />\r\n\r\n        </section>\r\n    );\r\n}","import {useSelector} from 'react-redux';\r\nimport {Navigate, useLocation} from 'react-router-dom';\r\nimport {selectUser} from '../store/slices/userSlice';\r\n\r\nexport function useIsAuth() {\r\n    const {user} = useSelector(selectUser);\r\n    const location = useLocation();\r\n    return (element) => {\r\n        return user._id\r\n            ? element\r\n            : <Navigate to=\"/auth/login\" state={{from: location}} />;\r\n    };\r\n}\r\n\r\nexport function useIsGuest(pathname) {\r\n    const {user} = useSelector(selectUser);\r\n    return (element) => {\r\n        return user._id\r\n            ? <Navigate to={pathname} />\r\n            : element;\r\n    };\r\n}\r\n\r\nexport function useIsAdmin(pathname) {\r\n    const {user} = useSelector(selectUser);\r\n    return (element) => {\r\n        return user._isAdmin\r\n            ? element\r\n            : <Navigate to={pathname} />;\r\n    };\r\n}","export function isTouchedError(formik, name){\r\n    return formik.errors[name] && formik.touched[name];\r\n}\r\n\r\nexport const Required = () => <span className='required-label'>*required</span>;\r\n","import './Login.scss';\r\nimport {useLocation, useNavigate} from 'react-router';\r\nimport {useIsGuest} from '../../../../guards/guards';\r\nimport {useDispatch} from 'react-redux';\r\nimport {useSelector} from 'react-redux';\r\nimport {selectUser, login} from '../../../../store/slices/userSlice';\r\nimport {toast} from 'react-toastify';\r\nimport {useFormik} from 'formik';\r\nimport * as yup from 'yup';\r\nimport {isTouchedError, Required} from '../../../../util/formik';\r\n\r\nconst initialValues = {\r\n    email: '',\r\n    password: '',\r\n};\r\n\r\nexport function Login() {\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    const {status, user, errors} = useSelector(selectUser);\r\n    let from = location.state?.from?.pathname || '/';\r\n    const isGuest = useIsGuest(from);\r\n\r\n    const formik = useFormik({\r\n        initialValues,\r\n        onSubmit: async (values) => {\r\n            try {\r\n                await dispatch(login(values)).unwrap();\r\n                navigate(from, {replace: true});\r\n            } catch (error) {\r\n                error.forEach(err => toast.error(err));\r\n            }\r\n        },\r\n        validationSchema: yup.object({\r\n            email: yup.string().required('Please enter your email'),\r\n            password: yup.string().required('Please enter your password'),\r\n        })\r\n    });\r\n\r\n    let disabled = ((status === 'loading')|| !formik.isValid || formik.isSubmitting || !formik.dirty);\r\n    const isError = isTouchedError.bind(null, formik);\r\n\r\n    return isGuest(\r\n        <form className='login-form' onSubmit={formik.handleSubmit}>\r\n\r\n            <label htmlFor=\"email\">E-mail<Required /></label>\r\n            <input type=\"text\" className={isError('email') ? 'error' : ''} placeholder=\"example@email.com\" id=\"email\" {...formik.getFieldProps('email')} />\r\n            {isError('email') ? <div className=\"errors\">{formik.errors.email}</div> : null}\r\n\r\n            <label htmlFor=\"password\">Password<Required /></label>\r\n            <input type=\"password\" className={isError('password') ? 'error' : ''} placeholder=\"******\" id=\"password\" {...formik.getFieldProps('password')} />\r\n            {isError('password') ? <div className=\"errors\">{formik.errors.password}</div> : null}\r\n\r\n            <input type=\"submit\" className=\"button submit-button\" value=\"Login\" disabled={disabled} />\r\n\r\n        </form>\r\n    );\r\n}","import './Register.scss';\r\nimport {useLocation, useNavigate} from 'react-router';\r\nimport {toast} from 'react-toastify';\r\nimport {useIsGuest} from '../../../../guards/guards';\r\nimport {useSelector} from 'react-redux';\r\nimport {register, selectUser} from '../../../../store/slices/userSlice';\r\nimport {useDispatch} from 'react-redux';\r\nimport {useFormik} from 'formik';\r\nimport * as yup from 'yup';\r\nimport {isTouchedError, Required} from '../../../../util/formik';\r\n\r\nconst initialValues = {\r\n    firstName: '',\r\n    lastName: '',\r\n    email: '',\r\n    phone: '',\r\n    address: '',\r\n    password: '',\r\n    repeatPassword: '',\r\n};\r\n\r\nexport function Register() {\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    const dispatch = useDispatch();\r\n    const {status, user, errors} = useSelector(selectUser);\r\n    let from = location.state?.from?.pathname || '/';\r\n    const isGuest = useIsGuest(from);\r\n    const formik = useFormik({\r\n        initialValues,\r\n        onSubmit: async (values) => {\r\n            try {\r\n                await dispatch(register(values)).unwrap();\r\n                navigate(from, {replace: true});\r\n            } catch (error) {\r\n                error.forEach(err => toast.error(err));\r\n            }\r\n        },\r\n        validationSchema: yup.object({\r\n            firstName: yup.string().required('Please enter your first name'),\r\n            lastName: yup.string().required('Please enter your last name'),\r\n            email: yup.string().email('Please enter a valid email').required('Please enter your email'),\r\n            password: yup.string().required('Please enter your password').min(6, 'Password needs to be at least 6 characters long'),\r\n            repeatPassword: yup.string().required('Please repeat your password').oneOf([yup.ref('password')], 'Passwords don\\'t match'),\r\n        })\r\n    });\r\n\r\n    let disabled = ((status === 'loading') || !formik.isValid || formik.isSubmitting || !formik.dirty);\r\n    const isError = isTouchedError.bind(null, formik);\r\n\r\n    return isGuest(\r\n        <form className='register-form' onSubmit={formik.handleSubmit}>\r\n\r\n            <label htmlFor=\"firstName\">First name<Required /></label>\r\n            <input type=\"text\" placeholder=\"John\" id=\"firstName\" className={isError('firstName') ? 'error' : ''} {...formik.getFieldProps('firstName')} />\r\n            {isError('firstName') ? <div className=\"errors\">{formik.errors.firstName}</div> : null}\r\n\r\n            <label htmlFor=\"lastName\">Last name<Required /></label>\r\n            <input type=\"text\" placeholder=\"Doe\" id=\"lastName\" className={isError('lastName') ? 'error' : ''} {...formik.getFieldProps('lastName')} />\r\n            {isError('lastName') ? <div className=\"errors\">{formik.errors.lastName}</div> : null}\r\n\r\n            <label htmlFor=\"email\">E-mail<Required /></label>\r\n            <input type=\"text\" placeholder=\"example@email.com\" id=\"email\" className={isError('email') ? 'error' : ''} {...formik.getFieldProps('email')} />\r\n            {isError('email') ? <div className=\"errors\">{formik.errors.email}</div> : null}\r\n\r\n            <label htmlFor=\"phone\">Phone number</label>\r\n            <input type=\"text\" placeholder=\"+359888123456\" id=\"phone\" className={isError('phone') ? 'error' : ''} {...formik.getFieldProps('phone')} />\r\n            {isError('phone') ? <div className=\"errors\">{formik.errors.phone}</div> : null}\r\n\r\n            <label htmlFor=\"address\">Address</label>\r\n            <input type=\"text\" id=\"address\" placeholder=\"City, 1 Example street, ap.1\" className={isError('address') ? 'error' : ''} {...formik.getFieldProps('address')} />\r\n            {isError('address') ? <div className=\"errors\">{formik.errors.address}</div> : null}\r\n\r\n            <label htmlFor=\"password\">Password<Required /></label>\r\n            <input type=\"password\" placeholder=\"******\" id=\"password\" className={(isError('password') || isError('repeatPassword')) ? 'error' : ''} {...formik.getFieldProps('password')} />\r\n            {isError('password') ? <div className=\"errors\">{formik.errors.password}</div> : null}\r\n\r\n            <label htmlFor=\"repeatPassword\">Repeat password<Required /></label>\r\n            <input type=\"password\" placeholder=\"******\" id=\"repeatPassword\" className={(isError('password') || isError('repeatPassword')) ? 'error' : ''} {...formik.getFieldProps('repeatPassword')} />\r\n            {(isError('password') || isError('repeatPassword')) ? <div className=\"errors\">{formik.errors.repeatPassword}</div> : null}\r\n\r\n            <input type=\"submit\" className=\"button submit-button\" value=\"Register\" disabled={disabled} />\r\n\r\n        </form>\r\n    );\r\n}","import {useNavigate} from 'react-router';\r\nimport {useEffect} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\nimport {logout} from '../../../store/slices/userSlice';\r\n\r\n\r\nexport function Logout() {\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n\r\n    async function logoutOnLoad() {\r\n        try {\r\n            await dispatch(logout());\r\n            navigate('/auth/login', {replace: true});\r\n        } catch {\r\n            navigate('/error');\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        logoutOnLoad();\r\n    });\r\n\r\n    return null;\r\n}","import {createContext, useEffect, useState} from 'react';\r\nimport {useSelector} from 'react-redux';\r\nimport {getAll} from '../../../services/wineService';\r\nimport {selectCart} from '../../../store/slices/cartSlice';\r\nimport {Outlet} from 'react-router-dom';\r\nimport {toast} from 'react-toastify';\r\n\r\nexport const CartContext = createContext();\r\n\r\nexport function Cart() {\r\n    const cart = useSelector(selectCart);\r\n    const [cartDetails, setCatDetails] = useState([]);\r\n    const cartTotal = Number(cartDetails.reduce((a, c) => {\r\n        return a + c.itemTotal;\r\n    }, 0).toFixed(2) || 0);\r\n\r\n    useEffect(() => {\r\n        async function loadCartDetails(query) {\r\n            try {\r\n                const {wines} = await getAll(query);\r\n                const details = wines.map(wine => ({wine, quantity: cart[wine._id], itemTotal: Number((wine.currentPrice * cart[wine._id] || 0).toFixed(2))}));\r\n                setCatDetails(details);\r\n            } catch ({message}) {\r\n                message.forEach(err => toast.error(err));\r\n            }\r\n        };\r\n\r\n        const wineIds = Object.keys(cart);\r\n        if (wineIds.length > 0) {\r\n            const query = new URLSearchParams();\r\n            Object.keys(cart).forEach(wineId => {query.append('_id', wineId);});\r\n            loadCartDetails(query.toString());\r\n        } else {\r\n            setCatDetails([]);\r\n        }\r\n    }, [cart]);\r\n\r\n    return (\r\n        <CartContext.Provider value={{cartDetails, cartTotal}}>\r\n            <Outlet />\r\n        </CartContext.Provider>\r\n    );\r\n}","import {Outlet} from 'react-router-dom';\r\nimport {useIsAuth} from '../../../guards/guards';\r\n\r\nexport function User() {\r\n    const isAuth = useIsAuth();\r\n    return isAuth(\r\n        <div className=\"container\">\r\n            <Outlet />\r\n        </div>\r\n    );\r\n}","import * as http from './http';\r\n\r\nconst endpoint = http.endpoint + '/order';\r\n\r\nexport async function getOrder(id) {\r\n    const order = await http.get(endpoint + '/' + id);\r\n    return order;\r\n}\r\n\r\nexport async function createOrder(data) {\r\n    const order = await http.post(endpoint, data);\r\n    return order;\r\n}\r\n\r\nexport async function getOrders(query = '') {\r\n    const orders = await http.get(endpoint + '?' + query);\r\n    return orders;\r\n}","import './Profile.scss';\r\nimport {useFormik} from 'formik';\r\nimport * as yup from 'yup';\r\nimport {useState} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {Link, useNavigate} from 'react-router-dom';\r\nimport {toast} from 'react-toastify';\r\nimport {useEffect} from 'react';\r\nimport {useIsAuth} from '../../../../guards/guards';\r\nimport {getOrders} from '../../../../services/orderService';\r\nimport {selectUser, update} from '../../../../store/slices/userSlice';\r\nimport {isTouchedError, Required} from '../../../../util/formik';\r\n\r\n\r\nexport function Profile() {\r\n    const {status, user, errors} = useSelector(selectUser);\r\n    const [orders, setOrders] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [isActive, setIsActive] = useState(false);\r\n    const isAuth = useIsAuth();\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n    const formik = useFormik({\r\n        initialValues: {\r\n            firstName: user.firstName,\r\n            lastName: user.lastName,\r\n            email: user.email,\r\n            phone: user.phone,\r\n            address: user.address,\r\n        },\r\n        onSubmit: async (values) => {\r\n            try {\r\n                await dispatch(update(values)).unwrap();\r\n                toast.success('Profile updated successfully!');\r\n                setIsActive(() => false);\r\n            } catch (error) {\r\n                error.forEach(err => toast.error(err));\r\n            }\r\n        },\r\n        validationSchema: yup.object({\r\n            firstName: yup.string().required('Please enter your first name'),\r\n            lastName: yup.string().required('Please enter your last name'),\r\n            email: yup.string().email('Please enter a valid email').required('Please enter your email'),\r\n            phone: yup.string().required('Please enter your phone number'),\r\n            address: yup.string().required('Please enter your address'),\r\n        })\r\n    });\r\n\r\n    let disabled = ((status === 'loading') || !formik.isValid || formik.isSubmitting || !formik.dirty);\r\n    const isError = isTouchedError.bind(null, formik);\r\n\r\n    useEffect(() => {\r\n        try {\r\n            loadOrders(user._id);\r\n        } catch (error) {\r\n            navigate('/error');\r\n        }\r\n\r\n        async function loadOrders(userId) {\r\n            setIsLoading(true);\r\n            try {\r\n                const query = new URLSearchParams();\r\n                query.append('_creator', user._id);\r\n                const orders = await getOrders(query.toString());\r\n                setOrders(() => orders);\r\n                setIsLoading(false);\r\n            } catch (error) {\r\n                // error.forEach(err => toast.error(err));\r\n                navigate('/error');\r\n            }\r\n        }\r\n    }, [user._id]);\r\n\r\n    const orderSummary = orders.map(({_id, _createdAt, value, status, items}) => {\r\n        return (\r\n            <li key={_id}>\r\n                <Link to={`/order/${_id}`} className=\"order-info\">\r\n                    <span className='order-date'>{(new Date(_createdAt)).toLocaleDateString()}</span>\r\n                    <span className='order-status'>{status}</span>\r\n                    <span className='order-items'>{items.length}</span>\r\n                    <span className='order-total'>{value.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span>\r\n                </Link>\r\n            </li>\r\n        );\r\n    });\r\n\r\n\r\n    return isAuth(\r\n        <section className=\"page checkout\">\r\n            <h1 className=\"page-title\">\r\n                User Profile\r\n            </h1>\r\n            <header className=\"section-header\">\r\n                <h4>Profile Summary</h4>\r\n            </header>\r\n\r\n\r\n            <form className='checkout-form' onSubmit={formik.handleSubmit}>\r\n\r\n                <div className=\"form-content\">\r\n                    <h4 className='group-title'>Personal Information</h4>\r\n                    <label htmlFor=\"firstName\">First name<Required /></label>\r\n                    <input disabled={!isActive} type=\"text\" placeholder=\"John\" id=\"firstName\" className={isError('firstName') ? 'error' : ''} {...formik.getFieldProps('firstName')} />\r\n                    {isError('firstName') ? <div className=\"errors\">{formik.errors.firstName}</div> : null}\r\n\r\n                    <label htmlFor=\"lastName\">Last name<Required /></label>\r\n                    <input disabled={!isActive} type=\"text\" placeholder=\"Doe\" id=\"lastName\" className={isError('lastName') ? 'error' : ''} {...formik.getFieldProps('lastName')} />\r\n                    {isError('lastName') ? <div className=\"errors\">{formik.errors.lastName}</div> : null}\r\n\r\n                    <label htmlFor=\"email\">E-mail<Required /></label>\r\n                    <input disabled={!isActive} type=\"text\" placeholder=\"example@email.com\" id=\"email\" className={isError('email') ? 'error' : ''} {...formik.getFieldProps('email')} />\r\n                    {isError('email') ? <div className=\"errors\">{formik.errors.email}</div> : null}\r\n\r\n                    <label htmlFor=\"phone\">Phone number<Required /></label>\r\n                    <input disabled={!isActive} type=\"text\" placeholder=\"+359888123456\" id=\"phone\" className={isError('phone') ? 'error' : ''} {...formik.getFieldProps('phone')} />\r\n                    {isError('phone') ? <div className=\"errors\">{formik.errors.phone}</div> : null}\r\n\r\n                    <label htmlFor=\"address\">Address<Required /></label>\r\n                    <input disabled={!isActive} type=\"text\" id=\"address\" placeholder=\"City, 1 Example street, ap.1\" className={isError('address') ? 'error' : ''} {...formik.getFieldProps('address')} />\r\n                    {isError('address') ? <div className=\"errors\">{formik.errors.address}</div> : null}\r\n                    {isActive ? <input type=\"submit\" className=\"button submit-button\" value=\"Update Profile\" disabled={disabled} /> : null}\r\n                    {isActive ? null : <button type='button' className=\"button\" onClick={() => setIsActive(() => true)} >Edit Profile</button>}\r\n                </div>\r\n\r\n\r\n                <div className=\"order-history\">\r\n                    <h4 className='group-title'>Ordering history</h4>\r\n                    <ul className=\"order-list\">\r\n                        <li className=\"order-info\">\r\n                            <span className='order-date'>Date</span>\r\n                            <span className='order-status'>Status</span>\r\n                            <span className='order-items'>Items</span>\r\n                            <span className='order-total'>Total</span>\r\n                        </li>\r\n                        {orderSummary}\r\n                    </ul>\r\n                </div>\r\n\r\n\r\n            </form>\r\n\r\n            <div className=\"logout-container\">\r\n                <Link className='button logout-button' to=\"/auth/logout\">Logout</Link>\r\n            </div>\r\n\r\n        </section>\r\n    );\r\n}","import './Checkout.scss';\r\nimport {useContext} from 'react';\r\nimport {CartContext} from '../Cart';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {selectUser} from '../../../../store/slices/userSlice';\r\nimport {toast} from 'react-toastify';\r\nimport {Navigate, useNavigate} from 'react-router-dom';\r\nimport {useFormik} from 'formik';\r\nimport * as yup from 'yup';\r\nimport {isTouchedError, Required} from '../../../../util/formik';\r\nimport {createOrder} from '../../../../services/orderService';\r\nimport {resetCart} from '../../../../store/slices/cartSlice';\r\n\r\nexport function Checkout() {\r\n    const {cartDetails, cartTotal} = useContext(CartContext);\r\n    const {status, user, errors} = useSelector(selectUser);\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n    const formik = useFormik({\r\n        initialValues: {\r\n            firstName: user.firstName,\r\n            lastName: user.lastName,\r\n            email: user.email,\r\n            phone: user.phone,\r\n            address: user.address,\r\n        },\r\n        onSubmit: async (values) => {\r\n            try {\r\n                const orderData = {\r\n                    recipient: values,\r\n                    items: cartDetails.map(i => ({wine: i.wine._id, quantity: i.quantity, price: i.wine.currentPrice})),\r\n                };\r\n                const order = await createOrder(orderData);\r\n                dispatch(resetCart());\r\n                toast.success('Thank you for your order!');\r\n                navigate(`/order/${order._id}`, {replace: true});\r\n            } catch (error) {\r\n                error.forEach(err => toast.error(err));\r\n            }\r\n        },\r\n        validationSchema: yup.object({\r\n            firstName: yup.string().required('Please enter your first name'),\r\n            lastName: yup.string().required('Please enter your last name'),\r\n            email: yup.string().email('Please enter a valid email').required('Please enter your email'),\r\n            phone: yup.string().required('Please enter your phone number'),\r\n            address: yup.string().required('Please enter your address'),\r\n        })\r\n    });\r\n\r\n    let disabled = ((status === 'loading') || !formik.isValid || formik.isSubmitting || (user._id ? false : !formik.dirty));\r\n    const isError = isTouchedError.bind(null, formik);\r\n\r\n    const itemSummary = cartDetails.map(({wine, quantity, itemTotal}) => {\r\n        return (\r\n            <li key={wine._id} className=\"item-info\">\r\n                <span className='item-label'>{wine.brand} | {wine.name}</span>\r\n                <span className='item-quantity'>x{quantity}</span>\r\n                <span className='item-total'>{itemTotal.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span>\r\n            </li>\r\n        );\r\n    });\r\n\r\n    return (\r\n        cartDetails.length === 0\r\n            ? <Navigate to=\"/cart\" replace={true} />\r\n            : <section className=\"page checkout container\">\r\n                <h1 className=\"page-title\">\r\n                    Order Checkout\r\n                </h1>\r\n                <header className=\"section-header\">\r\n                    <h4>Order Summary</h4>\r\n                </header>\r\n\r\n\r\n                <form className='checkout-form' onSubmit={formik.handleSubmit}>\r\n\r\n                    <div className=\"item-summary\">\r\n                        <h4 className='group-title'>Item summary</h4>\r\n                        <ul className=\"item-list\">\r\n                            {itemSummary}\r\n                        </ul>\r\n                        <div className=\"list-total\">\r\n                            <h4 className=\"order-total-label\">Order Total</h4>\r\n                            <h4 className=\"order-total-value\">{cartTotal.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</h4>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"form-content\">\r\n                        <h4 className='group-title'>Contact Information</h4>\r\n                        <label htmlFor=\"firstName\">First name<Required /></label>\r\n                        <input type=\"text\" placeholder=\"John\" id=\"firstName\" className={isError('firstName') ? 'error' : ''} {...formik.getFieldProps('firstName')} />\r\n                        {isError('firstName') ? <div className=\"errors\">{formik.errors.firstName}</div> : null}\r\n\r\n                        <label htmlFor=\"lastName\">Last name<Required /></label>\r\n                        <input type=\"text\" placeholder=\"Doe\" id=\"lastName\" className={isError('lastName') ? 'error' : ''} {...formik.getFieldProps('lastName')} />\r\n                        {isError('lastName') ? <div className=\"errors\">{formik.errors.lastName}</div> : null}\r\n\r\n                        <label htmlFor=\"email\">E-mail<Required /></label>\r\n                        <input type=\"text\" placeholder=\"example@email.com\" id=\"email\" className={isError('email') ? 'error' : ''} {...formik.getFieldProps('email')} />\r\n                        {isError('email') ? <div className=\"errors\">{formik.errors.email}</div> : null}\r\n\r\n                        <label htmlFor=\"phone\">Phone number<Required /></label>\r\n                        <input type=\"text\" placeholder=\"+359888123456\" id=\"phone\" className={isError('phone') ? 'error' : ''} {...formik.getFieldProps('phone')} />\r\n                        {isError('phone') ? <div className=\"errors\">{formik.errors.phone}</div> : null}\r\n\r\n                        <label htmlFor=\"address\">Address<Required /></label>\r\n                        <input type=\"text\" id=\"address\" placeholder=\"City, 1 Example street, ap.1\" className={isError('address') ? 'error' : ''} {...formik.getFieldProps('address')} />\r\n                        {isError('address') ? <div className=\"errors\">{formik.errors.address}</div> : null}\r\n                    </div>\r\n\r\n                    <input type=\"submit\" className=\"button submit-button\" value=\"Place Order\" disabled={disabled} />\r\n                </form>\r\n            </section>\r\n    );\r\n}","import './CartItem.scss';\r\nimport {useDispatch} from 'react-redux';\r\nimport {FaTrashAlt, FaPlus, FaMinus} from 'react-icons/fa';\r\nimport {addItem, removeItem, subtractItem} from '../../../../store/slices/cartSlice';\r\nimport {Link} from 'react-router-dom';\r\n\r\nexport function CartItem({wine, quantity, itemTotal, ordered}) {\r\n    const dispatch = useDispatch();\r\n\r\n    function quantityButtonClickHandler(event) {\r\n        switch (event.currentTarget.id) {\r\n            case 'increase':\r\n                return (dispatch(addItem(wine._id)));\r\n            case 'decrease':\r\n                return (dispatch(subtractItem(wine._id)));\r\n            case 'remove':\r\n                return (dispatch(removeItem(wine._id)));\r\n            default: return;\r\n        }\r\n    }\r\n\r\n    return (\r\n        wine\r\n            ? <article className=\"cart-item\">\r\n                <Link to={`/details/${wine._id}`} className='info image'><img src={wine.image} alt={wine.name} /></Link>\r\n                <div className='info product'>\r\n                    <p className=\"brand\">{wine.brand}</p>\r\n                    <Link to={`/details/${wine._id}`} className=\"name\">{wine.name}</Link>\r\n                    <p className=\"grapes\">{wine.grape.join(' ,')}</p>\r\n                    <div className=\"geo\">\r\n                        <span className=\"year\">{wine.year}</span> | <span className=\"country\">{wine.country}</span>\r\n                    </div>\r\n                </div>\r\n                <div className='info price'>{Number(wine.currentPrice.toFixed(2)).toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</div>\r\n                <div className='info quantity'>\r\n                    {ordered\r\n                        ? <span className=\"quantity-value\">{quantity}</span>\r\n                        : <>\r\n                            <button className=\"cart-item-button decrease\" onClick={quantityButtonClickHandler} id='decrease'><FaMinus /></button>\r\n                            <span className=\"quantity-value\">{quantity}</span>\r\n                            <button className=\"cart-item-button increase\" onClick={quantityButtonClickHandler} id='increase'><FaPlus /></button>\r\n                        </>\r\n                    }\r\n                </div>\r\n                <div className='info item-total'>{itemTotal.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</div>\r\n                {ordered\r\n                    ? null\r\n                    : <div className='remove-item-container'><button className=\"cart-item-button remove-item\" onClick={quantityButtonClickHandler} id=\"remove\"><FaTrashAlt /></button></div>\r\n                }\r\n            </article>\r\n            : null\r\n    );\r\n}","import './Summary.scss';\r\nimport {CartItem} from './CartItem';\r\nimport {Link, useLocation} from 'react-router-dom';\r\nimport {useContext} from 'react';\r\nimport {CartContext} from '../Cart';\r\nimport {useSelector} from 'react-redux';\r\nimport {selectUser} from '../../../../store/slices/userSlice';\r\n\r\nexport function Summary() {\r\n    const location = useLocation();\r\n    const {cartDetails, cartTotal} = useContext(CartContext);\r\n    const {user} = useSelector(selectUser);\r\n\r\n    const content = cartDetails.length === 0\r\n        ? <article className=\"empty-cart\">\r\n            <h4 className=\"heading\">Your cart is currently empty</h4>\r\n            <Link className='main-text' to=\"/catalogue\">Please have a look at our catalogue and select the best wine for your occasion</Link>\r\n            <Link className='button catalogue-button' to=\"/catalogue\">Catalogue</Link>\r\n        </article>\r\n        : <div className=\"cart-container\">\r\n            <div className='table-header'>\r\n                <h4 className='product'>Product</h4>\r\n                <h4 className='price'>Price</h4>\r\n                <h4 className='quantity'>Quantity</h4>\r\n                <h4 className='item-total'>Item Total</h4>\r\n            </div>\r\n            <div className='table-body'>\r\n                {cartDetails.map(({wine, quantity, itemTotal}) => <CartItem key={wine._id} wine={wine} quantity={quantity} itemTotal={itemTotal} />)}\r\n            </div>\r\n            <div className='table-footer'>\r\n                <div className=\"subtotal\">\r\n                    <div className=\"subtotal-label\">Subtotal:</div>\r\n                    <div className=\"subtotal-value\">{cartTotal.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</div>\r\n                </div>\r\n                <Link className='button checkout-button' to=\"/cart/checkout\">Proceed to checkout</Link>\r\n            </div>\r\n        </div>;\r\n\r\n    return (\r\n        <section className=\"page cart container\">\r\n            <h1 className=\"page-title\">Shopping Cart</h1>\r\n            {!user._id ?\r\n                <article className=\"guest-user\">\r\n                    <h4 className=\"heading\">You are still a guest user</h4>\r\n                    <Link className='main-text' to=\"/auth/login\" state={{from: location}}>Register or sign in to your account for additional functionality and a better experience</Link>\r\n                </article>\r\n                : null}\r\n            {content}\r\n        </section>\r\n    );\r\n}","import {useCallback, useEffect, useState} from 'react';\r\nimport {useSelector} from 'react-redux';\r\nimport {Link} from 'react-router-dom';\r\nimport {toast} from 'react-toastify';\r\nimport {getFavorites} from '../../../../services/userService';\r\nimport {selectUser} from '../../../../store/slices/userSlice';\r\nimport {ProductCard} from '../../../shared/ProductCard/ProductCard';\r\nimport './Favorites.scss';\r\n\r\nexport function Favorites() {\r\n    const {user} = useSelector(selectUser);\r\n    const [favorites, setFavorites] = useState([]);\r\n\r\n    const getUserFavorites = useCallback(async (user) => {\r\n        try {\r\n            const favoritesDetails = await getFavorites(user._id);\r\n            setFavorites(() => favoritesDetails);\r\n        } catch ({message}) {\r\n            message.forEach(err => toast.error(err));\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        getUserFavorites(user);\r\n    }, [getUserFavorites, user]);\r\n\r\n    const content = favorites.length === 0\r\n        ? <article className=\"empty-cart\">\r\n            <h4 className=\"heading\">Your haven't bookmarked any favorites yet</h4>\r\n            <Link className='main-text' to=\"/catalogue\">Please have a look at our catalogue and select the best wine for your occasion</Link>\r\n            <Link className='button catalogue-button' to=\"/catalogue\">Catalogue</Link>\r\n        </article>\r\n        : <div className=\"favorites-container\">\r\n            <header className=\"section-header\">\r\n                <h4>{user.firstName}'s selection</h4>\r\n            </header>\r\n\r\n            <div className=\"products-container\">\r\n                {favorites.map(f => <ProductCard key={f._id} product={f} />)}\r\n            </div>\r\n        </div>;\r\n\r\n    return (\r\n        <section className='page favorites'>\r\n            <h1 className=\"page-title\">\r\n                Favorites\r\n            </h1>\r\n            {content}\r\n        </section>\r\n\r\n    );\r\n}","import './Modal.scss';\r\nimport {disableBodyScroll, clearAllBodyScrollLocks} from 'body-scroll-lock';\r\nimport {createContext, createRef, useEffect, useState, useContext} from 'react';\r\n\r\nexport function Modal() {\r\n    const targetRef = createRef();\r\n    const {modalState, closeModal} = useContext(ModalContext);\r\n\r\n    useEffect(() => {\r\n        if (targetRef.current) {\r\n            disableBodyScroll(targetRef.current);\r\n        }\r\n        return () => clearAllBodyScrollLocks();\r\n    }, [targetRef]);\r\n\r\n    const onChoice = (choice) => {\r\n        closeModal();\r\n        modalState.callback(choice);\r\n    };\r\n\r\n    return (\r\n        modalState.active\r\n            ? < div className=\"overlay\" >\r\n                <div ref={targetRef} className=\"dialog-box\">\r\n                    <p className='message'>{modalState.message}</p>\r\n                    <div className=\"buttons\">\r\n                        <button onClick={() => onChoice(true)} className='button accept'>Confirm</button>\r\n                        <button onClick={() => onChoice(false)} className='button reject'>Cancel</button>\r\n                    </div>\r\n                </div>\r\n            </div >\r\n            : null\r\n    );\r\n}\r\n\r\nexport const ModalContext = createContext();\r\n\r\nconst initialState = {\r\n    active: false,\r\n    message: '',\r\n    callback: undefined,\r\n};\r\n\r\nexport function ModalProvider({children}) {\r\n    const [modalState, setModalState] = useState(initialState);\r\n\r\n\r\n    function createModal(message, callback) {\r\n        setModalState(state => ({\r\n            active: true,\r\n            message,\r\n            callback\r\n        }));\r\n    };\r\n\r\n    function closeModal() {\r\n        setModalState(initialState);\r\n    }\r\n\r\n    return (\r\n        <ModalContext.Provider value={{modalState, createModal, closeModal}}>{children}</ModalContext.Provider>\r\n    );\r\n}","import './Details.scss';\r\nimport {Link, useNavigate, useParams} from 'react-router-dom';\r\nimport {useState, useEffect, useContext} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {FaStar, FaRegStar} from 'react-icons/fa';\r\nimport {deleteOne, getOne} from '../../../services/wineService';\r\nimport {Loader} from '../../shared/Loader/Loader';\r\nimport {addFavorite, removeFavorite, selectUser} from '../../../store/slices/userSlice';\r\nimport {addItem} from '../../../store/slices/cartSlice';\r\nimport {toast} from 'react-toastify';\r\nimport {ModalContext} from '../../shared/Modal/Modal';\r\n\r\nexport function Details() {\r\n    const {wineId} = useParams();\r\n    const [wine, setWine] = useState({});\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const {user} = useSelector(selectUser);\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n    const {createModal} = useContext(ModalContext);\r\n\r\n    useEffect(() => {\r\n        getDetails(wineId);\r\n        async function getDetails(wineId) {\r\n            try {\r\n                const wine = await getOne(wineId);\r\n                setWine(() => wine);\r\n                setIsLoading(() => false);\r\n            } catch {\r\n                navigate('/error');\r\n            }\r\n        }\r\n    }, [navigate, wineId]);\r\n\r\n    function favoriteClickHandler(event) {\r\n        event.stopPropagation();\r\n        user?.favorites.includes(wine?._id)\r\n            ? dispatch(removeFavorite({userId: user._id, wineId: wine._id}))\r\n            : dispatch(addFavorite({userId: user._id, wineId: wine._id}));\r\n    }\r\n\r\n    function addToCartClickHandler() {\r\n        dispatch(addItem(wine._id));\r\n        toast.success('Wine added to cart');\r\n    }\r\n\r\n    async function DeleteClickHandler(confirmed) {\r\n        if (confirmed) {\r\n            try {\r\n                await deleteOne(wine._id);\r\n                navigate('/');\r\n            } catch {\r\n                navigate('/error');\r\n            }\r\n        }\r\n    }\r\n\r\n    const favorite = user.favorites.includes(wine?._id)\r\n        ? <FaStar onClick={favoriteClickHandler} />\r\n        : <FaRegStar onClick={favoriteClickHandler} />;\r\n\r\n    return (\r\n\r\n        isLoading\r\n            ? <Loader />\r\n            : <section className=\"page details container\">\r\n                <h1 className=\"page-title\">\r\n                    Wine Details\r\n                </h1>\r\n                <header className=\"section-header\">\r\n                    <h4>{wine.name} {wine.year}</h4>\r\n                    {user._id && !user._isAdmin && <div className=\"favorite-icon-container\">{favorite}</div>}\r\n                </header>\r\n\r\n                <div className=\"wine-details\">\r\n                    <div className=\"image-container\">\r\n                        <img src={wine.image} alt={wine.name} />\r\n                    </div>\r\n                    <div className=\"wine-data\">\r\n\r\n                        <div className=\"data-group\">\r\n                            <h4 className=\"group-title\">Specifications</h4>\r\n                            <ul className=\"data-list\">\r\n                                <li className=\"brand list-item\">\r\n                                    <span className=\"brand label\">brand:</span>\r\n                                    <span className=\"brand text\">{wine.brand}</span>\r\n                                </li>\r\n                                <li className=\"name list-item\">\r\n                                    <span className=\"name label\">name:</span>\r\n                                    <span className=\"name text\">{wine.name}</span>\r\n                                </li>\r\n                                <li className=\"type list-item\">\r\n                                    <span className=\"type label\">type:</span>\r\n                                    <span className=\"type text\">{wine.type}</span>\r\n                                </li>\r\n                                <li className=\"grape list-item\">\r\n                                    <span className=\"grape label\">grape:</span>\r\n                                    <span className=\"grape text\">{wine.grape.join(', ')}</span>\r\n                                </li>\r\n                                <li className=\"year list-item\">\r\n                                    <span className=\"year label\">vintage:</span>\r\n                                    <span className=\"year text\">{wine.year}</span>\r\n                                </li>\r\n                                <li className=\"country list-item\">\r\n                                    <span className=\"country label\">country:</span>\r\n                                    <span className=\"country text\">{wine.country}</span>\r\n                                </li>\r\n                                <li className=\"region list-item\">\r\n                                    <span className=\"region label\">region:</span>\r\n                                    <span className=\"region text\">{wine.region}</span>\r\n                                </li>\r\n                                <li className=\"volume list-item\">\r\n                                    <span className=\"volume label\">volume:</span>\r\n                                    <span className=\"volume text\">{wine.volume} litres</span>\r\n                                </li>\r\n                            </ul>\r\n                        </div>\r\n\r\n                        <div className=\"data-group\">\r\n                            <h4 className=\"group-title\">Description</h4>\r\n                            <p className=\"description\">{wine.description}</p>\r\n                        </div>\r\n\r\n                        <div className=\"prices\">\r\n                            {wine.isPromo\r\n                                ? <p className=\"price\">\r\n                                    <span className='discounted-label'>Super Price:</span>\r\n                                    <span className=\"old-price\">{wine.basePrice.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span>\r\n                                    <span className=\"current-price\">{wine.currentPrice.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span>\r\n                                </p>\r\n                                : <p>\r\n                                    <span>Price:</span>\r\n                                    <span className=\"base-price\">{wine.currentPrice.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span>\r\n                                </p>\r\n                            }\r\n                        </div>\r\n\r\n                        <div className=\"buttons\">\r\n                            {user._isAdmin\r\n                                ? <>\r\n                                    <Link to={`/admin/edit/${wine._id}`} className=\"button edit-button\" >Edit Wine</Link>\r\n                                    <button className=\"button delete-button\" onClick={() => createModal('Are you sure you want to delete this wine listing?', DeleteClickHandler)}>Delete Wine</button>\r\n                                </>\r\n                                : <button className=\"button add-to-cart\" onClick={addToCartClickHandler}>\r\n                                    Add to cart\r\n                                </button>\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n    );\r\n}","import {Outlet, useLocation} from 'react-router-dom';\r\nimport {useIsAdmin} from '../../../guards/guards';\r\n\r\nexport function Admin() {\r\n    const location = useLocation();\r\n    let from = location.state?.from?.pathname || '/';\r\n    const isAdmin = useIsAdmin(from);\r\n\r\n    return isAdmin(\r\n        <Outlet />\r\n    );\r\n}","import {useField} from 'formik';\r\nimport {useCallback, useEffect, useState} from 'react';\r\nimport {useDropzone} from 'react-dropzone';\r\nimport {Required} from '../../../util/formik';\r\nimport {FaTrashAlt} from 'react-icons/fa';\r\n\r\n\r\nexport function FileDropzone({name}) {\r\n    const [files, setFiles] = useState([]);\r\n    const [_, meta, helpers] = useField(name);\r\n    const onDrop = useCallback((accFiles, rejFiles) => {\r\n        const normalizedAcc = accFiles.map(file => ({file, errors: []}));\r\n        const files = [...normalizedAcc, ...rejFiles].map(file => Object.assign(file, {preview: URL.createObjectURL(file.file)}));\r\n        setFiles(() => files);\r\n        helpers.setValue(files);\r\n        helpers.setTouched(true, true);\r\n    }, []);\r\n\r\n    const determineClasses = useCallback((meta, isDragActive) => {\r\n        const classes = ['dropzone'];\r\n        if (isDragActive) {classes.push('active');};\r\n        if (meta.touched && meta.error) {classes.push('error');};\r\n        return classes.join(' ');\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        helpers.setValue(files);\r\n    }, [files]);\r\n\r\n    const {isDragActive, getRootProps, getInputProps} = useDropzone({\r\n        onDrop,\r\n        accept: 'image/*',\r\n        maxFiles: 1,\r\n        maxSize: 500 * 1024,\r\n        multiple: false,\r\n    });\r\n\r\n    const removeFile = (file) => {\r\n        setFiles(files => {\r\n            let updated = [...files.filter(curr => curr !== file)];\r\n            updated = updated.map(a => ({...a}));\r\n            if (updated.length === 1) {\r\n                updated[0].errors = updated[0].errors.filter(({code}) => code !== 'too-many-files');\r\n            }\r\n            return updated;\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className=\"files\">\r\n\r\n            <div className=\"dropzone-container\">\r\n                <label htmlFor=\"dropzone\">image<Required /></label>\r\n                <div {...getRootProps({className: determineClasses(meta, isDragActive)})}>\r\n                    <input id=\"dropzone\" {...getInputProps()} />\r\n                    <p>Drag&amp;drop files here, or click to select</p>\r\n                </div>\r\n                {\r\n                    meta.touched && meta.error && typeof meta.error === 'string'\r\n                        ? <div className=\"errors\">{meta.error}</div>\r\n                        : null\r\n                }\r\n            </div>\r\n\r\n            <ul className='file-list'>\r\n                {files.map((fw) => (\r\n                    <li className={fw.errors.length === 0 ? 'selected-file' : 'selected-file error'} key={fw.file.path}>\r\n                        <header className=\"item-header\">\r\n                            <div className=\"file-data\">\r\n                                <span className=\"filename\">{fw.file.path}</span>\r\n                            </div>\r\n                            <div className=\"errors\">\r\n                                {fw.errors.map(err => <p key={err.message}>{err.message}</p>)}\r\n                            </div>\r\n                            <button type='button' className='remove remove-input' onClick={() => removeFile(fw)}><FaTrashAlt /></button>\r\n                        </header>\r\n                        <img src={fw.preview} alt='' />\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n        </div >\r\n    );\r\n};","import './Create.scss';\r\nimport {ErrorMessage, Field, FieldArray, Form, Formik} from 'formik';\r\nimport {Fragment, useCallback} from 'react';\r\nimport * as yup from 'yup';\r\nimport {FaTrashAlt} from 'react-icons/fa';\r\nimport {Required} from '../../../../util/formik';\r\nimport {FileDropzone} from '../FileDropzone';\r\nimport {create} from '../../../../services/wineService';\r\nimport {useNavigate} from 'react-router-dom';\r\nimport {toast} from 'react-toastify';\r\n\r\nconst initialValues = {\r\n    brand: '',\r\n    name: '',\r\n    description: '',\r\n    type: '',\r\n    grape: [''],\r\n    country: '',\r\n    region: '',\r\n    year: 2021,\r\n    volume: 0.75,\r\n    basePrice: 0,\r\n    discountPercentage: 0,\r\n    files: [],\r\n};\r\n\r\nconst validationSchema =\r\n    yup.object({\r\n        brand: yup.string().required('Please enter wine brand'),\r\n        name: yup.string().required('Please enter wine name'),\r\n        description: yup.string().required('Please enter wine description'),\r\n        type: yup.mixed().required('Please enter wine type').oneOf(['red', 'white', 'rose', 'sparkling', 'dessert'], 'Type must be one of red, white, rose, sparkling or dessert'),\r\n        grape: yup.array(yup.string().required('Please enter grape')).min(1, 'Please enter at least 1 grape'),\r\n        country: yup.string().required('Please enter wine country'),\r\n        region: yup.string().required('Please enter wine region'),\r\n        year: yup.number().required('Please enter wine year').min(1900, 'Wine year must be after 1900'),\r\n        volume: yup.number().required('Please enter wine volume').moreThan(0, 'Wine volume must be positive'),\r\n        basePrice: yup.number().required('Please enter wine price').moreThan(0, 'Wine price must be greater than 0'),\r\n        discountPercentage: yup.number().min(0, 'Discount percentage must be between 0-100').max(100, 'Discount percentage must be between 0-100'),\r\n        files: yup.array(yup.object({errors: yup.array().max(0, 'Incorrect file')})).min(1, 'Please upload wine image'),\r\n    });\r\n\r\nexport function Create() {\r\n    const navigate = useNavigate();\r\n\r\n    const onSubmit = useCallback(async (values) => {\r\n        try {\r\n            const formData = new FormData();\r\n\r\n            Object.entries(values).forEach(([k, v]) => {\r\n                if (typeof v === 'string' || typeof v === 'number') {\r\n                    formData.append(k, v);\r\n                } else if (Array.isArray(v)) {\r\n                    if (k !== 'files') {\r\n                        v.forEach(i => {\r\n                            formData.append(k, i);\r\n                        });\r\n                    } else {\r\n                        v.forEach(({file}) => {\r\n                            formData.append(k, file);\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n            const wine = await create(formData);\r\n            navigate(`/details/${wine._id}`);\r\n        } catch (error) {\r\n            error.forEach(err => toast.error(err));\r\n        }\r\n    }, [navigate]);\r\n\r\n    const isError = useCallback(({touched, error}) => {\r\n        return (touched && error) ? 'error' : '';\r\n    }, []);\r\n\r\n    return (\r\n        <section className=\"create page container\">\r\n            <h1 className=\"page-title\">Create Form</h1>\r\n            <header className=\"section-header\"><h4>New Wine Listing</h4></header>\r\n            <Formik\r\n                initialValues={initialValues}\r\n                onSubmit={onSubmit}\r\n                validationSchema={validationSchema}\r\n            >\r\n                {(formik) => (\r\n                    <Form className='create-form'>\r\n                        <FileDropzone name=\"files\" />\r\n\r\n                        <div className=\"fields\">\r\n                            <label htmlFor=\"brand\">brand<Required /></label>\r\n                            <Field name=\"brand\">{({meta, field}) => <input type=\"text\" id=\"brand\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"brand\" />\r\n\r\n                            <label htmlFor=\"name\">name<Required /></label>\r\n                            <Field name=\"name\">{({meta, field}) => <input type=\"text\" id=\"name\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"name\" />\r\n\r\n                            <label htmlFor=\"type\">type<Required /></label>\r\n                            <Field name=\"type\">{({meta, field}) => <input type=\"text\" id=\"type\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"type\" />\r\n\r\n                            <FieldArray name='grape' {...formik.getFieldProps('grape')} >\r\n                                {({remove, push, form}) => (\r\n                                    <>\r\n                                        <label>grape<Required /></label>\r\n                                        {formik.values.grape.map((v, i) => (\r\n                                            <Fragment key={i}>\r\n                                                <Field name={`grape[${i}]`}>{({meta, field}) => (\r\n                                                    <div className=\"form-group\">\r\n                                                        <div className=\"group-main\">\r\n                                                            <input type=\"text\" id={`grape[${i}]`} className={isError(meta)} {...field} />\r\n                                                            {formik.values.grape.length > 1 ? <button className='remove-input' onClick={() => remove(i)}><FaTrashAlt /></button> : null}\r\n                                                        </div>\r\n                                                        <ErrorMessage component=\"div\" className=\"errors\" name={`grape[${i}]`} />\r\n                                                    </div>\r\n                                                )}\r\n                                                </Field>\r\n                                            </Fragment>\r\n                                        ))}\r\n\r\n                                        <button type='button' onClick={() => push('')} className='button secondary'>Add more grapes</button>\r\n                                    </>\r\n                                )}\r\n                            </FieldArray>\r\n\r\n                            <label htmlFor=\"description\">description<Required /></label>\r\n                            <Field name=\"description\">{({meta, field}) => <textarea rows=\"8\" type=\"text\" id=\"description\" className={isError(meta)} {...field}></textarea>}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"description\" />\r\n\r\n                            <label htmlFor=\"country\">country<Required /></label>\r\n                            <Field name=\"country\">{({meta, field}) => <input type=\"text\" id=\"country\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"country\" />\r\n\r\n                            <label htmlFor=\"region\">region<Required /></label>\r\n                            <Field name=\"region\">{({meta, field}) => <input type=\"text\" id=\"region\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"region\" />\r\n\r\n                            <label htmlFor=\"year\">year<Required /></label>\r\n                            <Field name=\"year\">{({meta, field}) => <input type=\"number\" id=\"year\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"year\" />\r\n\r\n                            <label htmlFor=\"volume\">volume<Required /></label>\r\n                            <Field name=\"volume\">{({meta, field}) => <input type=\"number\" id=\"volume\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"volume\" />\r\n\r\n                            <label htmlFor=\"basePrice\">base price<Required /></label>\r\n                            <Field name=\"basePrice\">{({meta, field}) => <input type=\"number\" id=\"basePrice\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"basePrice\" />\r\n\r\n                            <label htmlFor=\"discountPercentage\">discount percentage<Required /></label>\r\n                            <Field name=\"discountPercentage\">{({meta, field}) => <input type=\"number\" id=\"discountPercentage\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"discountPercentage\" />\r\n\r\n                            <input type=\"submit\" className=\"button submit-button\" value=\"Create Listing\" disabled={(!formik.isValid || formik.isSubmitting || !formik.dirty)} />\r\n\r\n                        </div>\r\n                    </Form>\r\n\r\n                )}\r\n            </Formik>\r\n\r\n        </section>\r\n    );\r\n}","import './Error.scss';\r\nimport {Link} from 'react-router-dom';\r\n\r\nexport function Error() {\r\n\r\n    return (\r\n        <section className=\"page error container\">\r\n            <h1 className=\"page-title\">Page Error</h1>\r\n            <header className=\"section-header\">\r\n                <h4>Looks like we have encountered a problem</h4>\r\n            </header>\r\n            <div className='main-text'>\r\n                <p>Please accept out apologies for the inconvenience caused. Clicking the button below button will lead you back to our home page.</p>\r\n            </div>\r\n\r\n            <Link className='button return' to=\"/\" >Return Home</Link>\r\n        </section >\r\n    );\r\n}","import {Fragment, useCallback, useState} from 'react';\r\nimport {useNavigate, useParams} from 'react-router-dom';\r\nimport {useEffect} from 'react';\r\nimport {getOne, update} from '../../../../services/wineService';\r\nimport {ErrorMessage, Field, FieldArray, Form, Formik} from 'formik';\r\nimport * as yup from 'yup';\r\nimport {FaTrashAlt} from 'react-icons/fa';\r\nimport {Required} from '../../../../util/formik';\r\nimport {FileDropzone} from '../FileDropzone';\r\n\r\nimport './Edit.scss';\r\nimport {toast} from 'react-toastify';\r\n\r\nconst initialValues = {\r\n    brand: '',\r\n    name: '',\r\n    description: '',\r\n    type: '',\r\n    grape: [''],\r\n    country: '',\r\n    region: '',\r\n    year: 2021,\r\n    volume: 0.75,\r\n    basePrice: 0,\r\n    discountPercentage: 0,\r\n    image: '',\r\n    files: [],\r\n    isNewImage: false,\r\n};\r\n\r\nconst validationSchema =\r\n    yup.object({\r\n        brand: yup.string().required('Please enter wine brand'),\r\n        name: yup.string().required('Please enter wine name'),\r\n        description: yup.string().required('Please enter wine description'),\r\n        type: yup.mixed().required('Please enter wine type').oneOf(['red', 'white', 'rose', 'sparkling', 'dessert'], 'Type must be one of red, white, rose, sparkling or dessert'),\r\n        grape: yup.array(yup.string().required('Please enter grape')).min(1, 'Please enter at least 1 grape'),\r\n        country: yup.string().required('Please enter wine country'),\r\n        region: yup.string().required('Please enter wine region'),\r\n        year: yup.number().required('Please enter wine year').min(1900, 'Wine year must be after 1900'),\r\n        volume: yup.number().required('Please enter wine volume').moreThan(0, 'Wine volume must be positive'),\r\n        basePrice: yup.number().required('Please enter wine price').moreThan(0, 'Wine price must be greater than 0'),\r\n        discountPercentage: yup.number().min(0, 'Discount percentage must be between 0-100').max(100, 'Discount percentage must be between 0-100'),\r\n        isNewImage: yup.boolean(),\r\n        image: yup.string().when('isNewImage', {is: false, then: yup.string().required('Please upload at least one image')}),\r\n        files: yup.array(yup.object({errors: yup.array().max(0, 'Incorrect file')})).when('isNewImage', {is: true, then: yup.array().min(1, 'Please upload wine image')}),\r\n    });\r\n\r\n\r\n\r\nexport function Edit() {\r\n    const [wine, setWine] = useState(initialValues);\r\n    const {wineId} = useParams();\r\n    const navigate = useNavigate();\r\n\r\n    const onSubmit = useCallback(async (values) => {\r\n        try {\r\n            const formData = new FormData();\r\n\r\n            Object.entries(values).forEach(([k, v]) => {\r\n                if (typeof v === 'string' || typeof v === 'number') {\r\n                    formData.append(k, v);\r\n                } else if (Array.isArray(v)) {\r\n                    if (k !== 'files') {\r\n                        v.forEach(i => {\r\n                            formData.append(k, i);\r\n                        });\r\n                    } else {\r\n                        v.forEach(({file}) => {\r\n                            formData.append(k, file);\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n            const updatedWine = await update(wineId, formData);\r\n            navigate(`/details/${updatedWine._id}`);\r\n        } catch (error) {\r\n            error.forEach(err => toast.error(err));\r\n        }\r\n    }, [navigate, wineId]);\r\n\r\n    const isError = useCallback(({touched, error}) => {\r\n        return (touched && error) ? 'error' : '';\r\n    }, []);\r\n\r\n\r\n    useEffect(() => {\r\n        try {\r\n            loadWine(wineId);\r\n        } catch {\r\n            navigate('/error');\r\n        }\r\n\r\n        async function loadWine(id) {\r\n            const wine = await getOne(id);\r\n            setWine(() => wine);\r\n        }\r\n    }, [navigate, wineId]);\r\n\r\n    return (\r\n        <section className=\"edit page container\">\r\n            <h1 className=\"page-title\">Edit Form</h1>\r\n            <header className=\"section-header\"><h4>Edit Wine Listing</h4></header>\r\n            <Formik\r\n                enableReinitialize={true}\r\n                initialValues={{...initialValues, ...wine, }}\r\n                onSubmit={onSubmit}\r\n                validationSchema={validationSchema}\r\n            >\r\n                {(formik) => (\r\n                    <Form className='edit-form'>\r\n\r\n                        {formik.values.isNewImage\r\n                            ? <div className=\"dropzone-wrapper\">\r\n                                <FileDropzone name=\"files\" />\r\n                                <button className='button secondary cancel-upload' type='button' onClick={() => {formik.setFieldValue('isNewImage', !formik.values.isNewImage); formik.setTouched({files: false});}} >Cancel upload</button>\r\n                            </div>\r\n                            : <div className='image-preview' >\r\n                                <label>image<Required /></label>\r\n                                <div className=\"image-container\">\r\n                                    <button type='button' className='preview-remove remove-input' onClick={() => formik.setFieldValue('isNewImage', !formik.values.isNewImage)}><FaTrashAlt /></button>\r\n                                    <img src={formik.values.image} alt='' />\r\n                                </div>\r\n                            </div>\r\n                        }\r\n\r\n                        <div className=\"fields\">\r\n                            <label htmlFor=\"brand\">brand<Required /></label>\r\n                            <Field name=\"brand\">{({meta, field}) => <input type=\"text\" id=\"brand\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"brand\" />\r\n\r\n                            <label htmlFor=\"name\">name<Required /></label>\r\n                            <Field name=\"name\">{({meta, field}) => <input type=\"text\" id=\"name\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"name\" />\r\n\r\n                            <label htmlFor=\"type\">type<Required /></label>\r\n                            <Field name=\"type\">{({meta, field}) => <input type=\"text\" id=\"type\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"type\" />\r\n\r\n                            <FieldArray name='grape' {...formik.getFieldProps('grape')} >\r\n                                {({remove, push, form}) => (\r\n                                    <>\r\n                                        <label>grape<Required /></label>\r\n                                        {formik.values.grape.map((v, i) => (\r\n                                            <Fragment key={i}>\r\n                                                <Field name={`grape[${i}]`}>{({meta, field}) => (\r\n                                                    <div className=\"form-group\">\r\n                                                        <div className=\"group-main\">\r\n                                                            <input type=\"text\" id={`grape[${i}]`} className={isError(meta)} {...field} />\r\n                                                            {formik.values.grape.length > 1 ? <button className='remove-input' onClick={() => remove(i)}><FaTrashAlt /></button> : null}\r\n                                                        </div>\r\n                                                        <ErrorMessage component=\"div\" className=\"errors\" name={`grape[${i}]`} />\r\n                                                    </div>\r\n                                                )}\r\n                                                </Field>\r\n                                            </Fragment>\r\n                                        ))}\r\n\r\n                                        <button type='button' onClick={() => push('')} className='button secondary'>Add more grapes</button>\r\n                                    </>\r\n                                )}\r\n                            </FieldArray>\r\n\r\n                            <label htmlFor=\"description\">description<Required /></label>\r\n                            <Field name=\"description\">{({meta, field}) => <textarea rows=\"8\" type=\"text\" id=\"description\" className={isError(meta)} {...field}></textarea>}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"description\" />\r\n\r\n                            <label htmlFor=\"country\">country<Required /></label>\r\n                            <Field name=\"country\">{({meta, field}) => <input type=\"text\" id=\"country\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"country\" />\r\n\r\n                            <label htmlFor=\"region\">region<Required /></label>\r\n                            <Field name=\"region\">{({meta, field}) => <input type=\"text\" id=\"region\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"region\" />\r\n\r\n                            <label htmlFor=\"year\">year<Required /></label>\r\n                            <Field name=\"year\">{({meta, field}) => <input type=\"number\" id=\"year\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"year\" />\r\n\r\n                            <label htmlFor=\"volume\">volume<Required /></label>\r\n                            <Field name=\"volume\">{({meta, field}) => <input type=\"number\" id=\"volume\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"volume\" />\r\n\r\n                            <label htmlFor=\"basePrice\">base price<Required /></label>\r\n                            <Field name=\"basePrice\">{({meta, field}) => <input type=\"number\" id=\"basePrice\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"basePrice\" />\r\n\r\n                            <label htmlFor=\"discountPercentage\">discount percentage<Required /></label>\r\n                            <Field name=\"discountPercentage\">{({meta, field}) => <input type=\"number\" id=\"discountPercentage\" className={isError(meta)} {...field} />}</Field>\r\n                            <ErrorMessage component=\"div\" className=\"errors\" name=\"discountPercentage\" />\r\n\r\n                            <input type=\"submit\" className=\"button submit-button\" value=\"Edit Listing\" disabled={(!formik.isValid || formik.isSubmitting || !formik.dirty)} />\r\n\r\n                        </div>\r\n                    </Form>\r\n                )}\r\n            </Formik>\r\n\r\n        </section>\r\n    );\r\n\r\n}","import {useEffect, useState} from 'react';\r\nimport {Link, useNavigate} from 'react-router-dom';\r\nimport {getOrders} from '../../../../services/orderService';\r\nimport './Dashboard.scss';\r\n\r\nexport function Dashboard() {\r\n    const [orders, setOrders] = useState([]);\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        loadOrders();\r\n\r\n        async function loadOrders() {\r\n            try {\r\n                const query = new URLSearchParams();\r\n                query.append('sort', '_createdAt');\r\n                const loaded = await getOrders(query.toString());\r\n                setOrders(() => loaded);\r\n            } catch {\r\n                navigate('/error');\r\n            }\r\n        }\r\n    }, [navigate]);\r\n\r\n\r\n    return (\r\n        <section className=\"page dashboard container\">\r\n            <h1 className=\"page-title\">Admin Dashboard</h1>\r\n\r\n            <header className=\"section-header\">\r\n                <h4>Latest Orders</h4>\r\n            </header>\r\n            <div className=\"dashboard-content\">\r\n                <ul className='order-list'>\r\n                    <li className=\"order-info headers\">\r\n                        <span className='order-id'>Number</span>\r\n                        <span className='order-date'>Date</span>\r\n                        <span className='order-status'>Status</span>\r\n                        <span className='order-items'>Items</span>\r\n                        <span className='order-total'>Total</span>\r\n                    </li>\r\n                    {orders.map(({_id, _createdAt, value, status, items}) => (\r\n                        <li key={_id} >\r\n                            <Link to={`/order/${_id}`} className=\"order-info\">\r\n                                <span className=\"order-id\">{_id}</span>\r\n                                <span className='order-date'>{(new Date(_createdAt)).toLocaleDateString()}</span>\r\n                                <span className='order-status'>{status}</span>\r\n                                <span className='order-items'>{items.length}</span>\r\n                                <span className='order-total'>{value.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</span>\r\n                            </Link>\r\n                        </li>\r\n                    ))}\r\n                </ul>\r\n            </div>\r\n        </section>\r\n    );\r\n}","import {useEffect, useState} from 'react';\r\nimport {useNavigate, useParams} from 'react-router-dom';\r\nimport {getOrder} from '../../../services/orderService';\r\nimport {CartItem} from '../Cart/Summary/CartItem';\r\nimport './OrderDetails.scss';\r\n\r\nexport function OrderDetails() {\r\n    const {orderId} = useParams();\r\n    const [order, setOrder] = useState(null);\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        loadOrder();\r\n\r\n        async function loadOrder() {\r\n            try {\r\n                const loaded = await getOrder(orderId);\r\n                setOrder(() => loaded);\r\n            } catch (error) {\r\n                navigate('/');\r\n            }\r\n        }\r\n    }, [navigate, orderId]);\r\n\r\n    const content = (\r\n        !order\r\n            ? null\r\n            : <>\r\n                <div className='table-body'>\r\n                    {order.items.map(({wine, quantity, itemTotal}) => <CartItem key={wine._id} wine={wine} quantity={quantity} itemTotal={itemTotal} ordered={true} />)}\r\n                </div>\r\n                <div className='table-footer'>\r\n                    <div className=\"complimentary\">\r\n                        <div className=\"status\">\r\n                            <div className=\"status-label\">Order Status:</div>\r\n                            <div className=\"status-value\">{order.status}</div>\r\n                        </div>\r\n                        <div className=\"date\">\r\n                            <div className=\"date-label\">Order Date:</div>\r\n                            <div className=\"date-value\">{new Date(order._createdAt).toLocaleDateString()}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"total\">\r\n                        <div className=\"total-label\">Order Total:</div>\r\n                        <div className=\"total-value\">{order.value.toLocaleString('en-GB', {style: 'currency', currency: 'EUR'})}</div>\r\n                    </div>\r\n                </div>\r\n            </>\r\n    );\r\n\r\n    return < section className=\"page order container\" >\r\n        <h1 className=\"page-title\">Order Details</h1>\r\n\r\n        <div className=\"order-container\">\r\n            <div className='table-header'>\r\n                <h4 className='product'>Product</h4>\r\n                <h4 className='price'>Price</h4>\r\n                <h4 className='quantity'>Quantity</h4>\r\n                <h4 className='item-total'>Item Total</h4>\r\n            </div>\r\n            {content}\r\n        </div>\r\n    </section >;\r\n};","import './App.scss';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport {ToastContainer} from 'react-toastify';\r\nimport {Route, Routes} from 'react-router';\r\nimport {Navigate} from 'react-router-dom';\r\nimport {Catalogue} from './components/pages/Catalogue/Catalogue';\r\nimport {Header} from './components/Header/Header';\r\nimport {Home} from './components/pages/Home/Home';\r\nimport {Footer} from './components/Footer/Footer';\r\nimport {Auth} from './components/pages/Auth/Auth';\r\nimport {Login} from './components/pages/Auth/Login/Login';\r\nimport {Register} from './components/pages/Auth/Register/Register';\r\nimport {Logout} from './components/pages/Auth/Logout';\r\nimport {Cart} from './components/pages/Cart/Cart';\r\nimport {useEffect, useRef} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\nimport {verify} from './store/slices/userSlice';\r\nimport {User} from './components/pages/User/User';\r\nimport {Profile} from './components/pages/User/Profile/Profile';\r\nimport {loadCart} from './store/slices/cartSlice';\r\nimport {Checkout} from './components/pages/Cart/Checkout/Checkout';\r\nimport {Summary} from './components/pages/Cart/Summary/Summary';\r\nimport {Favorites} from './components/pages/User/Favorites/Favorites';\r\nimport {Details} from './components/pages/Details/Details';\r\nimport {Admin} from './components/pages/Admin/Admin';\r\nimport {Create} from './components/pages/Admin/Create/Create';\r\nimport {Error} from './components/pages/Error/Error';\r\nimport {Edit} from './components/pages/Admin/Edit/Edit';\r\nimport {Modal} from './components/shared/Modal/Modal';\r\nimport {Dashboard} from './components/pages/Admin/Dashboard.js/Dashboard';\r\nimport {OrderDetails} from './components/pages/OrderDetails/OrderDetails';\r\n\r\n\r\nfunction App() {\r\n  const dispatch = useDispatch();\r\n  const mainRef = useRef();\r\n  useEffect(() => {\r\n    try {\r\n      dispatch(verify());\r\n      dispatch(loadCart());\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }, [dispatch]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Header mainRef={mainRef} />\r\n      <main className=\"site-content\" ref={mainRef}>\r\n        <Routes>\r\n          <Route path=\"/\" element={<Home />} />\r\n          <Route path=\"/details/:wineId\" element={<Details />} />\r\n          <Route path=\"/contacts\" element={<Home />} />\r\n          <Route path=\"/about\" element={<Home />} />\r\n          <Route path=\"/catalogue\" element={<Catalogue />} />\r\n          <Route path=\"/auth\" element={<Auth />}>\r\n            <Route path=\"login\" element={<Login />} />\r\n            <Route path=\"register\" element={<Register />} />\r\n            <Route path=\"logout\" element={<Logout />} />\r\n          </Route>\r\n          <Route path=\"/user\" element={<User />}>\r\n            <Route path=\"profile\" element={<Profile />} />\r\n            <Route path=\"favorites\" element={<Favorites />} />\r\n          </Route>\r\n          <Route path=\"/cart\" element={<Cart />}>\r\n            <Route path=\"\" element={<Summary />} />\r\n            <Route path=\"checkout\" element={<Checkout />} />\r\n          </Route>\r\n          <Route path=\"/admin\" element={<Admin />}>\r\n            <Route path=\"dashboard\" element={<Dashboard />} />\r\n            <Route path=\"create\" element={<Create />} />\r\n            <Route path=\"edit/:wineId\" element={<Edit />} />\r\n          </Route>\r\n          <Route path=\"/order/:orderId\" element={<OrderDetails />} />\r\n          <Route path=\"/error\" element={<Error />} />\r\n          <Route path=\"*\" element={<Navigate to=\"/\" />} />\r\n        </Routes>\r\n        <ToastContainer style={{ 'marginTop': '6em' }} />\r\n      </main>\r\n      <Footer />\r\n      <Modal />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;","import {configureStore} from '@reduxjs/toolkit';\r\nimport {cartReducer} from './slices/cartSlice';\r\nimport {userReducer} from './slices/userSlice';\r\n\r\nexport const store = configureStore({\r\n    reducer: {\r\n        user: userReducer,\r\n        cart: cartReducer,\r\n    }\r\n});","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './styles/index.scss';\r\nimport App from './App';\r\nimport {BrowserRouter} from 'react-router-dom';\r\nimport {Provider} from 'react-redux';\r\nimport {store} from './store/store';\r\nimport {ModalProvider} from './components/shared/Modal/Modal';\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <React.StrictMode>\r\n      <BrowserRouter>\r\n        <ModalProvider>\r\n          <App />\r\n        </ModalProvider>\r\n      </BrowserRouter>\r\n    </React.StrictMode>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}